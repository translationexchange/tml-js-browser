/*! tml-js-browser 04-03-2016 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=a("tml-js"),e=function(){};e.prototype=d.utils.extend(new d.ApiAdapterBase,{get:function(a,b,c){this.request("get",a,b,c)},post:function(a,b,c){this.request("post",a,b,c)},request:function(a,b,c,e){var f=new Date;e||(e=function(){});var g,h=new XMLHttpRequest;if(a.match(/^get$/i)){var i=this.serialize(c||{});""!==i&&(b=b+"?"+i),g=null}else g=this.serialize(c||{});if(d.logger.debug("get "+b),"withCredentials"in h)h.open(a,b,!0);else{if("undefined"==typeof XDomainRequest)return!1;h=new XDomainRequest,h.open(a,b)}h.setRequestHeader("Content-type","application/x-www-form-urlencoded"),h.onload=function(){var a=new Date;d.logger.debug("call took "+(a-f)+" mls"),e(null,h,h.responseText)},h.onerror=function(a){e(a,h)},h.send(g)},serialize:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}}),b.exports=e},{"tml-js":34}],2:[function(a,b,c){var d=a("tml-js"),e=function(a){this.initialize(a)};e.prototype=d.utils.extend(new d.CacheAdapterBase,{name:"browser",read_only:!1,create:function(){return window.localStorage},fetchFromPath:function(a,b,c){if("current_version"==a)return void this.fetchDefault(a,b,c);var d=this.config.path+"/"+this.config.version+"/"+a+".json",e=this;e.getRequest().get(d,{},function(d,f,g){d||200!=f.status||null===g?e.fetchDefault(a,b,c):e.store(a,g,function(){c(null,g)})})},fetch:function(a,b,c){var d=this.cache.getItem(this.getVersionedKey(a));d?(this.info("cache hit "+a),c(null,d)):(this.info("cache miss "+a),this.config.path?this.fetchFromPath(a,b,c):this.fetchDefault(a,b,c))},getRequest:function(){if(!this.ajax){var a=d.config.getApiAdapter("ajax");this.ajax=new a}return this.ajax},store:function(a,b,c){var d=this.getVersionedKey(a);this.info("cache store "+a),this.cache.setItem(d,this.stripExtensions(b)),c&&c(null,b)},del:function(a,b){this.info("cache del "+a),this.cache.removeItem(this.getVersionedKey(a)),b&&b(null)},exists:function(a,b){var c=this.cache.getItem(this.getVersionedKey(a));b&&b(!!c)},clear:function(a){for(var b in this.cache)b.match(/^tml_/)&&(b.match(/current_version/)||this.cache.removeItem(b));a&&a(null)}}),b.exports=e},{"tml-js":34}],3:[function(a,b,c){var d=a("tml-js"),e=function(a){this.initialize(a)};e.prototype=d.utils.extend(new d.CacheAdapterBase,{name:"inline",read_only:!0,cache:{},create:function(){return window[this.config.name]||{}},fetch:function(a,b,c){var e=a.split("/"),f=this.cache;return e.forEach(function(a){d.utils.isObject(f)&&(f=f[a])}),f?(this.info("cache hit "+a),f=JSON.stringify(f),void(c&&c(null,f))):(this.info("cache miss "+a),d.utils.isFunction(b)?void b(function(a,b){c(a,b)}):(f=b||null,f&&(f=JSON.stringify(f)),void(c&&c(null,f))))},store:function(a,b,c){return this.info("the cache is readonly. can't store data"),b},del:function(a,b){this.info("the cache is readonly. can't delete data")},exists:function(a,b){b&&b(!!this.cache[a])}}),b.exports=e},{"tml-js":34}],4:[function(a,b,c){var d=a("tml-js"),e=d.utils,f={printWelcomeMessage:function(a){console.log([" _______                  _       _   _             ______          _","|__   __|                | |     | | (_)           |  ____|        | |","   | |_ __ __ _ _ __  ___| | __ _| |_ _  ___  _ __ | |__  __  _____| |__   __ _ _ __   __ _  ___","   | | '__/ _` | '_ \\/ __| |/ _` | __| |/ _ \\| '_ \\|  __| \\ \\/ / __| '_ \\ / _` | '_ \\ / _` |/ _ \\","   | | | | (_| | | | \\__ \\ | (_| | |_| | (_) | | | | |____ >  < (__| | | | (_| | | | | (_| |  __/","   |_|_|  \\__,_|_| |_|___/_|\\__,_|\\__|_|\\___/|_| |_|______/_/\\_\\___|_| |_|\\__,_|_| |_|\\__, |\\___|","                                                                                       __/ |","                                                                                      |___/","   version "+a,"","   We are hiring! http://translationexchange.com/jobs "," "].join("\n"))},getBrowserLanguages:function(){var a=window.navigator;return a.languages||a.language&&[a.language]||a.userLanguage&&[a.userLanguage]||a.browserLanguage&&[a.browserLanguage]||null},includeLs:function(a){var b=document.createElement("div");if(e.isObject(a))for(var c in a)"type"==c?b.setAttribute("data-tml-language-selector",a[c]):b.setAttribute("data-tml-"+c,a[c]);else b.setAttribute("data-tml-language-selector","sideflags");document.body.appendChild(b)},includeAgent:function(a,b,c){var f=b.host||"https://tools.translationexchange.com/agent/stable/agent.min.js";if(b.cache){var g=(new Date).getTime();g-=g%b.cache,f+="?ts="+g}d.logger.debug("loading agent from "+f),e.addJS(window.document,"tml-agent",f,function(){Trex.init(a.key,b),c&&Trex.ready(c)})},getCurrentSource:function(a){var b=null,c=a.current_source||a.source;if(c&&(b=e.isFunction(c)?c():c),!b){var d=document.createElement("a");d.href=location.href,b=d.pathname}return b=b.replace(/^\//,""),b.match(/\/$/)&&(b+="index"),""===b&&(b="index"),b},getCurrentLocale:function(a,b){var c=null;if(b)c=e.isFunction(b)?b():b;else if(c=(window.location.search.match(/[?&]locale=([^&]+)(&|$)/)||[])[1])this.updateCurrentLocale(a,c);else{var d=this.getCookie(a);c=d.locale}return c},updateCurrentLocale:function(a,b){var c=f.getCookie(a);c=c||{},c.locale=b,this.setCookie(a,c)},getCookie:function(a){for(var b=e.getCookieName(a),c=b+"=",d=document.cookie.split(";"),f=0;f<d.length;f++){for(var g=d[f];" "==g.charAt(0);)g=g.substring(1);if(-1!=g.indexOf(c))return e.decode(g.substring(c.length,g.length))}return{}},setCookie:function(a,b){var c=e.getCookieName(a);document.cookie=c+"="+e.encode(b)+"; path=/"}};b.exports={printWelcomeMessage:f.printWelcomeMessage,getBrowserLanguages:f.getBrowserLanguages,includeTools:f.includeTools,getCurrentSource:f.getCurrentSource,getCurrentLocale:f.getCurrentLocale,updateCurrentLocale:f.updateCurrentLocale,getCookie:f.getCookie,setCookie:f.setCookie,includeLs:f.includeLs,includeAgent:f.includeAgent}},{"tml-js":34}],5:[function(a,b,c){var d=["a","span","i","b","img","strong","s","em","u","sub","sup","var","code","kbd"],e=["br","hr"];b.exports={isEmptyString:function(a){return!a.replace(/[\s\n\r\t\0\x0b\xa0\xc2]/g,"")},isInline:function(a){return 1==a.nodeType&&!a.hasAttribute("isolate")&&-1!=d.indexOf(a.tagName.toLowerCase())&&!this.isOnlyChild(a)},hasInlineSiblings:function(a){return a.parentNode&&a.parentNode.childNodes.length>1&&a.previousSibling&&(this.isInline(a.previousSibling)||this.isValidText(a.previousSibling))||a.nextSibling&&(this.isInline(a.nextSibling)||this.isValidText(a.nextSibling))},isSelfClosing:function(a){return!a.firstChild},isValidText:function(a){return a?3==a.nodeType&&!this.isEmptyString(a.nodeValue):!1},isSeparator:function(a){return a?1==a.nodeType&&-1!=e.indexOf(a.tagName.toLowerCase()):!1},hasChildNodes:function(a){return a.childNodes?a.childNodes.length>0:!1},isBetweenSeparators:function(a){return this.isSeparator(a.previousSibling)&&!this.isValidText(a.nextSibling)?!0:this.isSeparator(a.nextSibling)&&!this.isValidText(a.previousSibling)?!0:!1},isOnlyChild:function(a){return a.parentNode?1==a.parentNode.childNodes.length:!1},matchesSelectors:function(a,b,c){var d,e="string"==typeof b?[b]:b;if(e)for(var f=0,g=e.length;g>f;f++){var h=e[f]+(c?","+e[f]+" *":"");if(d=a.matches&&a.matches(h)||a.webkitMatches&&a.webkitMatches(h)||a.mozMatches&&a.mozMatches(h)||a.msMatches&&a.msMatches(h))return!0}return!1},nodeInfo:function(a){var b=[a.nodeType];return 1==a.nodeType&&b.push(a.tagName),this.isInline(a)&&b.push("inline"),this.hasInlineSiblings(a)&&b.push("sentence"),this.hasInlineSiblings(a)||b.push("only translatable"),this.isSelfClosing(a)&&b.push("self closing"),this.isOnlyChild(a)&&b.push("only child"),3==this.nodeType&&b.push("value: "+a.nodeValue),"["+b.join(", ")+"]"}}},{}],6:[function(a,b,c){!function(a,d){function e(b){if(a)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}"object"==typeof c?(b.exports=d(),e(b.exports)):"function"==typeof define&&define.amd?define([],d):e(d())}(window,function(){var b=a("tml-js"),c=a("./helpers"),d=a("./tokenizers/dom"),e=a("tiny-emitter"),f=new e,g=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;return b=b.utils.extend(b,{version:"0.4.40",on:f.on.bind(f),off:f.off.bind(f),once:f.once.bind(f),emit:f.emit.bind(f),app:null,block_options:[],root_element:null,options:{},init:function(a,d){a=a||{},b.options=a,b.config.debug=a.debug?a.debug:b.config.debug,a.preferred_languages=a.preferred_languages||c.getBrowserLanguages(),a.current_source||(a.current_source=function(){return c.getCurrentSource({})}),(b.config.debug||a.info)&&c.printWelcomeMessage(b.version),b.initApplication(a,function(){b.startKeyListener(),b.startSourceListener(a),d&&d()})},startKeyListener:function(){if(b.getApplication().isInlineModeEnabled()){var a=b.getApplication(),c=3e3;setInterval(function(){a.submitMissingTranslationKeys()},c)}},refreshSource:function(a){var d=this,e=c.getCurrentSource(a),f=b.getApplication(),g=(b.utils.generateKey(e),f.current_locale),h=function(){d.tokenizer&&d.tokenizer.updateAllNodes()};f.getSource(e)||f.loadSources([e],g,function(a){a.length>0&&a[0]&&a[0].sources&&a[0].sources.length>0?f.loadSources(a[0].sources,f.current_locale,h):h()})},startSourceListener:function(a){function c(b){return function(){b&&b.apply(history,arguments),d.refreshSource(a)}}if(a.translateBody){var d=this;b.getApplication();window.history.pushState=c(window.history.pushState),window.history.replaceState=c(window.history.replaceState),window.addEventListener("popstate",c())}},initApplication:function(d,e){var f=new Date,h=c.getCookie(d.key),i=null;d.cache&&d.cache.version&&(i=d.cache.version),b.config.registerApiAdapter("ajax",a("./api_adapters/ajax")),b.config.api="ajax",b.config.registerCacheAdapters({inline:a("./cache_adapters/inline"),browser:a("./cache_adapters/browser")}),d=b.utils.merge(b.config,{delayed_flush:!0,api:"ajax",current_source:c.getCurrentSource(d),current_locale:c.getCurrentLocale(d.key,d.current_locale),current_translator:h.translator?new b.Translator(h.translator):null,accepted_locales:window.navigator.languages,cache:{enabled:!0,adapter:"browser",version:i,version_check_interval:d.version_check_interval||60}},d),d.fetch_version="browser"==d.cache.adapter&&!i,b.config.initCache(d.key),b.app=new b.Application({key:d.key,token:h.oauth?h.oauth.token:null,host:d.host,cdn_host:d.cdn_host}),b.app.init(d,function(a){(d.translateBody||d.translate_body)&&g&&b.translateElement(document),b.domReady(function(){!d.translateBody&&!d.translate_body||g||b.translateElement(document.body);var a=new Date;b.logger.debug("page render took "+(a-f)+" mls"),(d.translateTitle||d.translate_title)&&""!==document.title&&(document.title=b.translateLabel(document.title)),d.agent||(d.agent={}),d.language_selector&&c.includeLs(d.language_selector),c.includeAgent(b.app,{host:d.agent.host,cache:d.agent.cache||864e6,domains:d.agent.domains||{},locale:b.app.current_locale,source:b.app.current_source,sdk:d.sdk||"tml-js v"+b.version,css:b.app.css,languages:b.app.languages},function(){"function"==typeof d.onLoad&&d.onLoad(b.app),b.emit("load"),e&&e()})})})},domReady:function(a){!document.readyState||/ded|te/.test(document.readyState)?a():document.addEventListener("DOMContentLoaded",a,!1)},changeLanguage:function(a){b.app.changeLanguage(a,function(d){c.updateCurrentLocale(b.options.key,a),b.config.currentLanguage=b.app.getCurrentLanguage(),this.tokenizer&&this.tokenizer.updateAllNodes?this.tokenizer.updateAllNodes():window.location.reload(),b.utils.isFunction(b.options.onLanguageChange)&&b.options.onLanguageChange(d),b.emit("language-change",d)}.bind(this))},translate:function(a,c,d,e){if(!b.app)throw new Error("Invalid application.");var f=b.utils.normalizeParams(a,c,d,e);return f.label=f.label.replace(/\s\s+/g," "),f.options=b.utils.extend({},{current_locale:b.app.current_locale,current_source:b.app.current_source,current_translator:b.app.current_translator,block_options:b.block_options||[]},f.options),b.app.getCurrentLanguage().translate(f)},translateLabel:function(a,c,d,e){var f=b.utils.normalizeParams(a,c,d,e);return f.options.skip_decorations=!0,b.translate(f)},translateElement:function(a){a="string"==typeof a?document.getElementById(a):a,b.config.currentLanguage=b.app.getCurrentLanguage(),this.tokenizer=new d(a,{},{debug:!1,current_source:b.app.current_source||"index",current_translator:b.app.current_translator}),/ded|te/.test(document.readyState)?(this.tokenizer.translateDOM(document.body),this.translateNow()):g&&(document.body&&this.tokenizer.translateDOM(document.body),this.translateNow())},translateNow:function(){var a,c=this.tokenizer,d=function(d){var e=[];d.length>0&&(d.forEach(function(a){var b=(a.target,a.addedNodes||[]);if(b.length>0)for(var c=b.length-1;c>-1;c--){var d=b[c];d.tagName&&-1!=d.tagName.toLowerCase().indexOf("tml:")||d.tagName&&-1!=d.tagName.toLowerCase().indexOf("script")||e.push(d)}}),e.forEach(function(a){c.translateDOM(a)}),"interactive"==document.readyState&&(!b.options.translateBody||b.options.disableAutoTranslate)&&a.disconnect())};a=new g(d),a.observe(document,{subtree:!0,attributes:!0,attributeOldValue:!1,childList:!0,characterData:!0,characterDataOldValue:!1})},translateTextNode:function(a,c,d){var e=b.utils.sanitizeString(d);if(!b.utils.isNumber(e)&&null!==e&&0!==e.length){var f=this.translate(e);/^\s/.test(d)&&(f=" "+f),/\s$/.test(d)&&(f+=" ");var g=document.createElement("span");g.innerHTML=f,a.replaceChild(g,c)}},translateTextElements:function(a){if(!b.utils.element("tml_status_node")){console.log("Initializing text nodes...");var c=document.createElement("div");c.id="tml_status_node",c.style.display="none",document.body.appendChild(c);for(var d=[],e=document.createTreeWalker(a||document.body,NodeFilter.SHOW_TEXT,null,!1);e.nextNode();)d.push(e.currentNode);console.log("Found "+d.length+" text nodes");for(i=0;i<d.length;i++){var f=d[i],g=f.parentNode;if(g&&"script"!=g.tagName&&"SCRIPT"!=g.tagName){var h=f.nodeValue||"";if(-1==h.indexOf("<img")&&-1==h.indexOf("<!-")){h.split(". ");this.translateTextNode(g,f,h)}}}}},getApplication:function(){return b.app},getCurrentSource:function(){return b.app.current_source},getCurrentTranslator:function(){return b.app.current_translator},getCurrentLanguage:function(){return b.app.getCurrentLanguage()},block:function(a,c){b.block_options.unshift(a),c(),b.block_options.pop()},beginBlock:function(a){b.block_options.unshift(a)},endBlock:function(){b.block_options.pop()},clearCache:function(){b.config.getCache().clear()}}),{tml:b,tr:b.translate,trl:b.translateLabel,tre:b.translateElement,tml_application:b.getApplication,tml_current_source:b.getCurrentSource,tml_current_translator:b.getCurrentTranslator,tml_current_language:b.getCurrentLanguage,tml_block:b.block,tml_begin_block:b.beginBlock,tml_end_block:b.endBlock,util:b.utils}})},{"./api_adapters/ajax":1,"./cache_adapters/browser":2,"./cache_adapters/inline":3,"./helpers":4,"./tokenizers/dom":7,"tiny-emitter":12,"tml-js":34}],7:[function(a,b,c){var d=a("tml-js"),e=d.config,f=d.utils,g=a("../helpers/dom-helpers"),h=function(a,b,c){this.doc=a,this.context=b||{},this.tokens=[],this.options=c||{}};h.prototype={contentCache:[],contentNodes:[],translatedNodes:[],getOption:function(a){return"undefined"==typeof this.options[a]||null===this.options[a]?f.hashValue(e.translator_options,a):this.options[a]},translate:function(){return this.translateTree(this.doc)},updateAllNodes:function(){for(var a=0,b=this.contentCache.length;b>a;a++)this.contentCache[a].container&&(this.contentCache[a].container.innerHTML=this.translateTml(this.contentCache[a].tml,this.contentCache[a].data))},replaceNodes:function(a){var b,c,d,e,f=document.createElement("tml:inline"),g=a[0]&&a[0].parentNode,h="";if(g){if(c=a.map(function(a){return h+=a.innerHTML||a.nodeValue,this.generateTmlTags(a)}.bind(this)).join(""),d=this.tokens,e=this.translateTml(c),!e||this.isEmptyString(c)||this.isUntranslatableText(h)||!this.isTranslatable(g))return;a.length!==g.childNodes.length?(g.insertBefore(f,a[0]),f.innerHTML=e,f.insertAdjacentHTML("beforebegin","\n"),f.insertAdjacentHTML("afterend","\n"),a.forEach(function(a){g.removeChild(a)}),b=f):(g.insertBefore(f,a[0]),f.insertAdjacentHTML("beforebegin",e),g.removeChild(f),f=null,a.forEach(function(a){g.removeChild(a)}),b=g),-1==this.contentNodes.indexOf(b)&&(this.contentCache.push({container:b,tml:c,data:d}),this.contentNodes.push(b))}},translateDOM:function(a){if(-1===this.translatedNodes.indexOf(a)&&(this.translatedNodes.push(a),3!=a.nodeType)){var b=1==a.nodeType&&this.getSourceBlock(a);b&&window.tml_begin_block({source:b});for(var c=[],d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];e&&this.isTranslatable(e)&&(3==e.nodeType||g.isInline(e)&&g.hasInlineSiblings(e)?c.push(e):(this.replaceNodes(c),this.translateDOM(e),c=[]))}c.length>0&&(1==c.length&&1==c[0].nodeType?this.translateDOM(c[0]):this.replaceNodes(c)),b&&window.tml_end_block()}},getSourceBlock:function(a){if(e.sourceElements){var b=g.matchesSelectors(a,e.sourceElements);if(b)return a.getAttribute("name")||a.getAttribute("id")||a.getAttribute("class")}return a.getAttribute("data-tml-source")||!1},isTranslatable:function(a){return 8==a.nodeType?!1:(3==a.nodeType&&(a=a.parentNode),1==a.nodeType?!g.matchesSelectors(a,[].concat(this.getOption("nodes.scripts")||[],this.getOption("ignore_elements")||[],["[notranslate]",".notranslate","tml\\:label"]),!0):!0)},translateTml:function(a,b){if(a=this.generateDataTokens(a),b=b||this.tokens,!this.isValidTml(a))return null;var c=a;if(this.getOption("split_sentences")){var d=f.splitSentences(a);if(d){var e=this;return d.forEach(function(a){var d=e.getOption("debug")?e.debugTranslation(a):window.tr(a,b,e.options);c=c.replace(a,d)}),this.resetContext(),c}}return a=a.replace(/[\n]/g,"").replace(/\s\s+/g," ").trim(),c=this.getOption("debug")?this.debugTranslation(a):window.tr(a,b,this.options),this.resetContext(),c},generateTmlTags:function(a){if(3==a.nodeType)return this.escapeHtml(a.nodeValue);if(!this.isTranslatable(a)){var b=this.contextualize(this.adjustName(a),a.outerHTML);return"{"+b+"}"}var c=a.tagName.toLowerCase();if("var"==c)return this.registerDataTokenFromVar(a);for(var d="",e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];d+=3==f.nodeType?this.escapeHtml(f.nodeValue):this.generateTmlTags(f)}var h,i=this.generateHtmlToken(a),j=this.contextualize(this.adjustName(a),i),k=this.sanitizeValue(d);return h=g.isSelfClosing(a)?"{"+j+"}":"<"+j+">"+k+"</"+j+">"},registerDataTokenFromVar:function(a){var b={},c="var";if(a.attributes)for(var d=0;d<a.attributes.length;d++){var e=a.attributes[d];""===e.value?c=e.name:b[e.name]=e.value}return b.value=b.value||a.innerHTML,c=this.contextualize(c,a.innerHTML),"{"+c+"}"},resetContext:function(){this.tokens=[].concat(this.context)},isShortToken:function(a,b){return-1!=this.getOption("nodes.short").indexOf(a.toLowerCase())||b.length<20},generateDataTokens:function(a){var b=this;a=this.sanitizeValue(a);var c=null;if(this.getOption("data_tokens.date.enabled")){c=b.getOption("data_tokens.date.name");var d=b.getOption("data_tokens.date.formats");d.forEach(function(d){var e=d[0],f=(d[1],a.match(e));f&&f.forEach(function(d){var e=d,f=b.contextualize(c,e),g="{"+f+"}";a=a.replace(d,g)})})}var e=this.getOption("data_tokens.rules");return e&&e.forEach(function(c){if(c.enabled){var d=a.match(c.regex);d&&d.forEach(function(d){var e=d.trim();if(""!==e){var f=b.contextualize(c.name,e),g=d.replace(e,"{"+f+"}");a=a.replace(d,g)}})}}),a},generateHtmlToken:function(a,b){var c=a.tagName.toLowerCase(),d=a.attributes,e={};if(b=b?b:"{$0}",0===d.length)return g.isSelfClosing(a)?g.isSeparator(a)?"<"+c+"/>":"<"+c+"></"+c+">":"<"+c+">"+b+"</"+c+">";for(var h=0;h<d.length;h++)e[d[h].name]=d[h].value;var i=f.keys(e);i.sort();var j=[];return i.forEach(function(a){var b=-1!=e[a].indexOf("'")?'"':"'";j.push(a+"="+b+e[a]+b)}),j=j.join(" "),g.isSelfClosing(a)?"<"+c+" "+j+"></"+c+">":"<"+c+" "+j+">"+b+"</"+c+">"},adjustName:function(a){var b=a.tagName.toLowerCase(),c=this.getOption("name_mapping");return b=c[b]?c[b]:b},contextualize:function(a,b){if(this.tokens[a]&&this.tokens[a]!=b){var c=0,d=a.match(/\d+$/);return d&&d.length>0&&(c=parseInt(d[d.length-1]),a=a.replace(""+c,"")),a+=c+1,this.contextualize(a,b)}return this.tokens[a]=b,a},isEmptyString:function(a){return a=a.replace(/[\s\n\r\t\0\x0b\xa0\xc2]/g,""),""===a},isUntranslatableText:function(a){return this.isEmptyString(a)||a.match(/^[0-9,.\s]+$/)},isValidTml:function(a){var b=/<\/?([a-z][a-z0-9]*)\b[^>]*>|{([a-z0-9_\.]+)}/gi;return!this.isEmptyString(a.replace(b,""))},sanitizeValue:function(a){return a.replace(/^\s+/,"")},escapeHtml:function(a){var b=document.createElement("div");return b.appendChild(document.createTextNode(a)),b.innerHTML},debug:function(a){this.doc=a,this.debugTree(a,0)},debugTree:function(a,b){var c=new Array(b+1).join("=");if(console.log(c+"=> "+typeof a+": "+g.nodeInfo(a)),a.childNodes)for(var d=this,e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];d.debugTree(f,b+1)}},debugTranslation:function(a){return this.getOption("debug_format").replace("{$0}",a)}},b.exports=h},{"../helpers/dom-helpers":5,"tml-js":34}],8:[function(a,b,c){function d(){return e.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function e(a){return this instanceof e?(this.length=0,this.parent=void 0,"number"==typeof a?f(this,a):"string"==typeof a?g(this,a,arguments.length>1?arguments[1]:"utf8"):h(this,a)):arguments.length>1?new e(a,arguments[1]):new e(a)}function f(a,b){if(a=o(a,0>b?0:0|p(b)),!e.TYPED_ARRAY_SUPPORT)for(var c=0;b>c;c++)a[c]=0;return a}function g(a,b,c){("string"!=typeof c||""===c)&&(c="utf8");var d=0|r(b,c);return a=o(a,d),a.write(b,c),a}function h(a,b){if(e.isBuffer(b))return i(a,b);if(X(b))return j(a,b);if(null==b)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(b.buffer instanceof ArrayBuffer)return k(a,b);if(b instanceof ArrayBuffer)return l(a,b)}return b.length?m(a,b):n(a,b)}function i(a,b){var c=0|p(b.length);return a=o(a,c),b.copy(a,0,0,c),a}function j(a,b){var c=0|p(b.length);a=o(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function k(a,b){var c=0|p(b.length);a=o(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function l(a,b){return e.TYPED_ARRAY_SUPPORT?(b.byteLength,a=e._augment(new Uint8Array(b))):a=k(a,new Uint8Array(b)),a}function m(a,b){var c=0|p(b.length);a=o(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function n(a,b){var c,d=0;"Buffer"===b.type&&X(b.data)&&(c=b.data,d=0|p(c.length)),a=o(a,d);for(var e=0;d>e;e+=1)a[e]=255&c[e];return a}function o(a,b){e.TYPED_ARRAY_SUPPORT?a=e._augment(new Uint8Array(b)):(a.length=b,a._isBuffer=!0);var c=0!==b&&b<=e.poolSize>>>1;return c&&(a.parent=Y),a}function p(a){if(a>=d())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+d().toString(16)+" bytes");return 0|a}function q(a,b){if(!(this instanceof q))return new q(a,b);var c=new e(a,b);return delete c.parent,c}function r(a,b){"string"!=typeof a&&(a=""+a);var c=a.length;if(0===c)return 0;for(var d=!1;;)switch(b){case"ascii":case"binary":case"raw":case"raws":return c;case"utf8":case"utf-8":return Q(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return T(a).length;default:if(d)return Q(a).length;b=(""+b).toLowerCase(),d=!0}}function s(a,b,c){var d=!1;if(b=0|b,c=void 0===c||c===1/0?this.length:0|c,a||(a="utf8"),0>b&&(b=0),c>this.length&&(c=this.length),b>=c)return"";for(;;)switch(a){case"hex":return E(this,b,c);case"utf8":case"utf-8":return A(this,b,c);case"ascii":return C(this,b,c);case"binary":return D(this,b,c);case"base64":return z(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function t(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;d>g;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))throw new Error("Invalid hex string");a[c+g]=h}return g}function u(a,b,c,d){return U(Q(b,a.length-c),a,c,d)}function v(a,b,c,d){return U(R(b),a,c,d)}function w(a,b,c,d){return v(a,b,c,d)}function x(a,b,c,d){return U(T(b),a,c,d)}function y(a,b,c,d){return U(S(b,a.length-c),a,c,d)}function z(a,b,c){return 0===b&&c===a.length?V.fromByteArray(a):V.fromByteArray(a.slice(b,c))}function A(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;c>e;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(c>=e+h){var i,j,k,l;switch(h){case 1:128>f&&(g=f);break;case 2:i=a[e+1],128===(192&i)&&(l=(31&f)<<6|63&i,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],128===(192&i)&&128===(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j,l>2047&&(55296>l||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128===(192&i)&&128===(192&j)&&128===(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k,l>65535&&1114112>l&&(g=l))}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return B(d)}function B(a){var b=a.length;if(Z>=b)return String.fromCharCode.apply(String,a);for(var c="",d=0;b>d;)c+=String.fromCharCode.apply(String,a.slice(d,d+=Z));return c}function C(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(127&a[e]);return d}function D(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function E(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=P(a[f]);return e}function F(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function G(a,b,c){if(a%1!==0||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function H(a,b,c,d,f,g){if(!e.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(b>f||g>b)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range")}function I(a,b,c,d){0>b&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);f>e;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function J(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);f>e;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function K(a,b,c,d,e,f){if(b>e||f>b)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range");if(0>c)throw new RangeError("index out of range")}function L(a,b,c,d,e){return e||K(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),W.write(a,b,c,d,23,4),c+4}function M(a,b,c,d,e){return e||K(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),W.write(a,b,c,d,52,8),c+8}function N(a){if(a=O(a).replace(_,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function O(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function P(a){return 16>a?"0"+a.toString(16):a.toString(16)}function Q(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;d>g;g++){if(c=a.charCodeAt(g),c>55295&&57344>c){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(56320>c){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=e-55296<<10|c-56320|65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,128>c){if((b-=1)<0)break;f.push(c)}else if(2048>c){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(65536>c){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(1114112>c))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function R(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function S(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);g++)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function T(a){return V.toByteArray(N(a))}function U(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}var V=a("base64-js"),W=a("ieee754"),X=a("is-array");c.Buffer=e,c.SlowBuffer=q,c.INSPECT_MAX_BYTES=50,e.poolSize=8192;var Y={};e.TYPED_ARRAY_SUPPORT=function(){function a(){}try{var b=new Uint8Array(1);return b.foo=function(){return 42},b.constructor=a,42===b.foo()&&b.constructor===a&&"function"==typeof b.subarray&&0===b.subarray(1,1).byteLength}catch(c){return!1}}(),e.isBuffer=function(a){return!(null==a||!a._isBuffer)},e.compare=function(a,b){if(!e.isBuffer(a)||!e.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var c=a.length,d=b.length,f=0,g=Math.min(c,d);g>f&&a[f]===b[f];)++f;return f!==g&&(c=a[f],d=b[f]),d>c?-1:c>d?1:0},e.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(a,b){if(!X(a))throw new TypeError("list argument must be an Array of Buffers.");if(0===a.length)return new e(0);var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var d=new e(b),f=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(d,f),f+=g.length}return d},e.byteLength=r,e.prototype.length=void 0,e.prototype.parent=void 0,e.prototype.toString=function(){var a=0|this.length;return 0===a?"":0===arguments.length?A(this,0,a):s.apply(this,arguments)},e.prototype.equals=function(a){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:0===e.compare(this,a)},e.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... ")),"<Buffer "+a+">"},e.prototype.compare=function(a){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?0:e.compare(this,a)},e.prototype.indexOf=function(a,b){function c(a,b,c){for(var d=-1,e=0;c+e<a.length;e++)if(a[c+e]===b[-1===d?0:e-d]){if(-1===d&&(d=e),e-d+1===b.length)return c+d}else d=-1;return-1}if(b>2147483647?b=2147483647:-2147483648>b&&(b=-2147483648),b>>=0,0===this.length)return-1;if(b>=this.length)return-1;if(0>b&&(b=Math.max(this.length+b,0)),"string"==typeof a)return 0===a.length?-1:String.prototype.indexOf.call(this,a,b);if(e.isBuffer(a))return c(this,a,b);if("number"==typeof a)return e.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,a,b):c(this,[a],b);throw new TypeError("val must be string, number or Buffer")},e.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},e.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},e.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b=0|b,isFinite(c)?(c=0|c,void 0===d&&(d="utf8")):(d=c,c=void 0);else{var e=d;d=b,b=0|c,c=e}var f=this.length-b;if((void 0===c||c>f)&&(c=f),a.length>0&&(0>c||0>b)||b>this.length)throw new RangeError("attempt to write outside buffer bounds");d||(d="utf8");for(var g=!1;;)switch(d){case"hex":return t(this,a,b,c);case"utf8":case"utf-8":return u(this,a,b,c);case"ascii":return v(this,a,b,c);case"binary":return w(this,a,b,c);case"base64":return x(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y(this,a,b,c);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),g=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)
}};var Z=4096;e.prototype.slice=function(a,b){var c=this.length;a=~~a,b=void 0===b?c:~~b,0>a?(a+=c,0>a&&(a=0)):a>c&&(a=c),0>b?(b+=c,0>b&&(b=0)):b>c&&(b=c),a>b&&(b=a);var d;if(e.TYPED_ARRAY_SUPPORT)d=e._augment(this.subarray(a,b));else{var f=b-a;d=new e(f,void 0);for(var g=0;f>g;g++)d[g]=this[g+a]}return d.length&&(d.parent=this.parent||this),d},e.prototype.readUIntLE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},e.prototype.readUIntBE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},e.prototype.readUInt8=function(a,b){return b||G(a,1,this.length),this[a]},e.prototype.readUInt16LE=function(a,b){return b||G(a,2,this.length),this[a]|this[a+1]<<8},e.prototype.readUInt16BE=function(a,b){return b||G(a,2,this.length),this[a]<<8|this[a+1]},e.prototype.readUInt32LE=function(a,b){return b||G(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},e.prototype.readUInt32BE=function(a,b){return b||G(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},e.prototype.readIntLE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},e.prototype.readIntBE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},e.prototype.readInt8=function(a,b){return b||G(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},e.prototype.readInt16LE=function(a,b){b||G(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},e.prototype.readInt16BE=function(a,b){b||G(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},e.prototype.readInt32LE=function(a,b){return b||G(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},e.prototype.readInt32BE=function(a,b){return b||G(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},e.prototype.readFloatLE=function(a,b){return b||G(a,4,this.length),W.read(this,a,!0,23,4)},e.prototype.readFloatBE=function(a,b){return b||G(a,4,this.length),W.read(this,a,!1,23,4)},e.prototype.readDoubleLE=function(a,b){return b||G(a,8,this.length),W.read(this,a,!0,52,8)},e.prototype.readDoubleBE=function(a,b){return b||G(a,8,this.length),W.read(this,a,!1,52,8)},e.prototype.writeUIntLE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||H(this,a,b,c,Math.pow(2,8*c),0);var e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},e.prototype.writeUIntBE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||H(this,a,b,c,Math.pow(2,8*c),0);var e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},e.prototype.writeUInt8=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,1,255,0),e.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[b]=a,b+1},e.prototype.writeUInt16LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):I(this,a,b,!0),b+2},e.prototype.writeUInt16BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):I(this,a,b,!1),b+2},e.prototype.writeUInt32LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=a):J(this,a,b,!0),b+4},e.prototype.writeUInt32BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):J(this,a,b,!1),b+4},e.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);H(this,a,b,c,e-1,-e)}var f=0,g=1,h=0>a?1:0;for(this[b]=255&a;++f<c&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},e.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);H(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=0>a?1:0;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},e.prototype.writeInt8=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,1,127,-128),e.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),0>a&&(a=255+a+1),this[b]=a,b+1},e.prototype.writeInt16LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):I(this,a,b,!0),b+2},e.prototype.writeInt16BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):I(this,a,b,!1),b+2},e.prototype.writeInt32LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):J(this,a,b,!0),b+4},e.prototype.writeInt32BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,2147483647,-2147483648),0>a&&(a=4294967295+a+1),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):J(this,a,b,!1),b+4},e.prototype.writeFloatLE=function(a,b,c){return L(this,a,b,!0,c)},e.prototype.writeFloatBE=function(a,b,c){return L(this,a,b,!1,c)},e.prototype.writeDoubleLE=function(a,b,c){return M(this,a,b,!0,c)},e.prototype.writeDoubleBE=function(a,b,c){return M(this,a,b,!1,c)},e.prototype.copy=function(a,b,c,d){if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&c>d&&(d=c),d===c)return 0;if(0===a.length||0===this.length)return 0;if(0>b)throw new RangeError("targetStart out of bounds");if(0>c||c>=this.length)throw new RangeError("sourceStart out of bounds");if(0>d)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);var f,g=d-c;if(this===a&&b>c&&d>b)for(f=g-1;f>=0;f--)a[f+b]=this[f+c];else if(1e3>g||!e.TYPED_ARRAY_SUPPORT)for(f=0;g>f;f++)a[f+b]=this[f+c];else a._set(this.subarray(c,c+g),b);return g},e.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),b>c)throw new RangeError("end < start");if(c!==b&&0!==this.length){if(0>b||b>=this.length)throw new RangeError("start out of bounds");if(0>c||c>this.length)throw new RangeError("end out of bounds");var d;if("number"==typeof a)for(d=b;c>d;d++)this[d]=a;else{var e=Q(a.toString()),f=e.length;for(d=b;c>d;d++)this[d]=e[d%f]}return this}},e.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(e.TYPED_ARRAY_SUPPORT)return new e(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;c>b;b+=1)a[b]=this[b];return a.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var $=e.prototype;e._augment=function(a){return a.constructor=e,a._isBuffer=!0,a._set=a.set,a.get=$.get,a.set=$.set,a.write=$.write,a.toString=$.toString,a.toLocaleString=$.toString,a.toJSON=$.toJSON,a.equals=$.equals,a.compare=$.compare,a.indexOf=$.indexOf,a.copy=$.copy,a.slice=$.slice,a.readUIntLE=$.readUIntLE,a.readUIntBE=$.readUIntBE,a.readUInt8=$.readUInt8,a.readUInt16LE=$.readUInt16LE,a.readUInt16BE=$.readUInt16BE,a.readUInt32LE=$.readUInt32LE,a.readUInt32BE=$.readUInt32BE,a.readIntLE=$.readIntLE,a.readIntBE=$.readIntBE,a.readInt8=$.readInt8,a.readInt16LE=$.readInt16LE,a.readInt16BE=$.readInt16BE,a.readInt32LE=$.readInt32LE,a.readInt32BE=$.readInt32BE,a.readFloatLE=$.readFloatLE,a.readFloatBE=$.readFloatBE,a.readDoubleLE=$.readDoubleLE,a.readDoubleBE=$.readDoubleBE,a.writeUInt8=$.writeUInt8,a.writeUIntLE=$.writeUIntLE,a.writeUIntBE=$.writeUIntBE,a.writeUInt16LE=$.writeUInt16LE,a.writeUInt16BE=$.writeUInt16BE,a.writeUInt32LE=$.writeUInt32LE,a.writeUInt32BE=$.writeUInt32BE,a.writeIntLE=$.writeIntLE,a.writeIntBE=$.writeIntBE,a.writeInt8=$.writeInt8,a.writeInt16LE=$.writeInt16LE,a.writeInt16BE=$.writeInt16BE,a.writeInt32LE=$.writeInt32LE,a.writeInt32BE=$.writeInt32BE,a.writeFloatLE=$.writeFloatLE,a.writeFloatBE=$.writeFloatBE,a.writeDoubleLE=$.writeDoubleLE,a.writeDoubleBE=$.writeDoubleBE,a.fill=$.fill,a.inspect=$.inspect,a.toArrayBuffer=$.toArrayBuffer,a};var _=/[^+\/0-9A-Za-z-_]/g},{"base64-js":9,ieee754:10,"is-array":11}],9:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g||b===l?62:b===h||b===m?63:i>b?-1:i+10>b?b-i+26+26:k+26>b?b-k:j+26>b?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;g>d;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;g>e;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0),l="-".charCodeAt(0),m="_".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}("undefined"==typeof c?this.base64js={}:c)},{}],10:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],11:[function(a,b,c){var d=Array.isArray,e=Object.prototype.toString;b.exports=d||function(a){return!!a&&"[object Array]"==e.call(a)}},{}],12:[function(a,b,c){function d(){}d.prototype={on:function(a,b,c){var d=this.e||(this.e={});return(d[a]||(d[a]=[])).push({fn:b,ctx:c}),this},once:function(a,b,c){function d(){e.off(a,d),b.apply(c,arguments)}var e=this;return d._=b,this.on(a,d,c)},emit:function(a){var b=[].slice.call(arguments,1),c=((this.e||(this.e={}))[a]||[]).slice(),d=0,e=c.length;for(d;e>d;d++)c[d].fn.apply(c[d].ctx,b);return this},off:function(a,b){var c=this.e||(this.e={}),d=c[a],e=[];if(d&&b)for(var f=0,g=d.length;g>f;f++)d[f].fn!==b&&d[f].fn._!==b&&e.push(d[f]);return e.length?c[a]=e:delete c[a],this}},b.exports=d},{}],13:[function(a,b,c){b.exports={default_locale:"en",languages:[{locale:"en",name:"English",english_name:"English",native_name:"English",flag_url:"https://s3-us-west-1.amazonaws.com/trex-snapshots/flags/default/languages/16/en.png"}],threshold:1,css:".tml_not_translated { border-bottom: 1px dotted red; } .tml_translated { border-bottom: 1px dotted green; } .tml_fallback { border-bottom: 1px dotted #e90; } .tml_pending { border-bottom: 1px dotted #e90; } .tml_locked { border-bottom: 1px dotted blue; } .tml_language_case { padding:0px 2px; border: 1px dotted blue; border-radius: 2px; } .tml_token { background: #eee; padding:0px 2px; border: 1px dotted #ccc; border-radius: 2px; color: black; }"}},{}],14:[function(a,b,c){b.exports={enabled:!0,default_locale:"en",source_separator:"@:@",delayed_flush:!1,debug:!1,default_tokens:{html:{data:{ndash:"&ndash;",mdash:"&mdash;",iexcl:"&iexcl;",iquest:"&iquest;",quot:"&quot;",ldquo:"&ldquo;",rdquo:"&rdquo;",lsquo:"&lsquo;",rsquo:"&rsquo;",laquo:"&laquo;",raquo:"&raquo;",nbsp:"&nbsp;",lsaquo:"&lsaquo;",rsaquo:"&rsaquo;",br:"<br/>",lbrace:"{",rbrace:"}",trade:"&trade;"},decoration:{strong:"<strong>{$0}</strong>",bold:"<strong>{$0}</strong>",b:"<strong>{$0}</strong>",em:"<em>{$0}</em>",italic:"<i>{$0}</i>",i:"<i>{$0}</i>",link:"<a href='{$href}' class='{$class}' style='{$style}'>{$0}</a>",br:"<br>{$0}",strike:"<strike>{$0}</strike>",div:"<div id='{$id}' class='{$class}' style='{$style}'>{$0}</div>",span:"<span id='{$id}' class='{$class}' style='{$style}'>{$0}</span>",h1:"<h1>{$0}</h1>",h2:"<h2>{$0}</h2>",h3:"<h3>{$0}</h3>"}},text:{data:{ndash:"–",mdash:"-",iexcl:"¡",iquest:"¿",quot:'"',ldquo:"“",rdquo:"”",lsquo:"‘",rsquo:"’",laquo:"«",raquo:"»",nbsp:" ",lsaquo:"‹",rsaquo:"›",br:"\n",lbrace:"{",rbrace:"}",trade:"™"},decoration:{strong:"{$0}",bold:"{$0}",b:"{$0}",em:"{$0}",italic:"{$0}",i:"{$0}",link:"{$0}{$1}",br:"\n{$0}",strike:"{$0}",div:"{$0}",span:"{$0}",h1:"{$0}",h2:"{$0}",h3:"{$0}"}}},translator_options:{debug:!1,debug_format_html:"<span style='font-size:20px;color:red;'>{</span> {$0} <span style='font-size:20px;color:red;'>}</span>",debug_format:"{{{{$0}}}}",split_sentences:!0,decoration_token_format:"[]",ignore_elements:[".notranslate"],nodes:{ignored:[],scripts:["iframe","script","noscript","style","audio","video","map","object","track","embed","svg","ruby","pre"],inline:["a","span","i","b","img","strong","s","em","u","sub","sup","var","code"],"short":["i","b"],splitters:["br","hr"]},attributes:{labels:["title","alt"]},name_mapping:{b:"bold",i:"italic",a:"link",img:"picture"},data_tokens:{special:{enable:!0,regex:/(&[^;]*;)/g},date:{enabled:!0,formats:[[/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d+,\s+\d+/g,"{month} {day}, {year}"],[/(January|February|March|April|May|June|July|August|September|October|November|December)\s+\d+,\s+\d+/g,"{month} {day}, {year}"],[/\d+\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec),\s+\d+/g,"{day} {month}, {year}"],[/\d+\s+(January|February|March|April|May|June|July|August|September|October|November|December),\s+\d+/g,"{day} {month}, {year}"]],name:"date"},rules:[{enabled:!0,name:"phone",regex:/(\d{1}-)?\d{3}-\d{3}-\d{4}|\d?\(\d{3}\)\s*\d{3}-\d{4}|(\d.)?\d{3}.\d{3}.\d{4}/g},{enabled:!0,name:"email",regex:/[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|io|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?/g},{enabled:!0,name:"price",regex:/\$\d*(,\d*)*(\.\d*)?/g},{enabled:!0,name:"fraction",regex:/\d+\/\d+/g},{enabled:!0,name:"num",regex:/\b\d+(,\d*)*(\.\d*)?%?\b/g}]}},context_rules:{number:{variables:{}},gender:{variables:{"@gender":"gender"}},genders:{variables:{"@genders":function(a){var b=[];return a.forEach(function(a){b.push(a.gender)}),b}}},date:{variables:{}},time:{variables:{}}}}},{}],15:[function(a,b,c){b.exports={locale:"en",english_name:"English",flag_url:"https://s3-us-west-1.amazonaws.com/trex-snapshots/flags/default/languages/16/en.png",contexts:{list:{rules:{other:{description:"{token} contains at least 2 elements"},one:{description:"{token} contains 1 element",conditions:"(= 1 @count)",conditions_expression:["=",1,"@count"]}},keys:["one","other"],default_key:"other",token_expression:"/.*(items|list)(\\d)*$/",variables:["@count"],token_mapping:["unsupported",{one:"{$0}",other:"{$1}"}]},date:{rules:{future:{description:"{token} is in the past",conditions:"(< @date (today))",conditions_expression:["<","@date",["today"]]},present:{description:"{token} is in the present",conditions:"(= @date (today))",conditions_expression:["=","@date",["today"]]},past:{description:"{token} is in the future",conditions:"(> @date (today))",conditions_expression:[">","@date",["today"]]}},keys:["past","present","future"],default_key:"present",token_expression:"/.*(date|time)(\\d)*$/",variables:["@date"],token_mapping:["unsupported","unsupported",{past:"{$0}",present:"{$1}",future:"{$2}"}]},number:{rules:{one:{description:"{token} is 1",examples:"1",conditions:"(= @n 1)",conditions_expression:["=","@n",1]},other:{description:"{token} is not 1",examples:"0, 2-999; 1.2, 2.07..."}},keys:["one","other"],default_key:"other",token_expression:"/.*(count|num|minutes|seconds|hours|sum|total)(\\d)*$/",variables:["@n"],token_mapping:[{one:"{$0}",other:"{$0::plural}"},{one:"{$0}",other:"{$1}"}]},gender:{rules:{female:{description:"{token} is a female",conditions:"(= 'female' @gender)",conditions_expression:["=","female","@gender"]},male:{description:"{token} is a male",conditions:"(= 'male' @gender)",conditions_expression:["=","male","@gender"]},other:{description:"{token}'s gender is unknown"}},keys:["male","female","other"],default_key:"other",token_expression:"/.*(user|translator|profile|actor|target)(\\d)*$/",variables:["@gender"],token_mapping:[{other:"{$0}"},{male:"{$0}",female:"{$1}",other:"{$0}/{$1}"},{male:"{$0}",female:"{$1}",other:"{$2}"}]},genders:{rules:{female:{description:"{token} contains 1 female",conditions:"(&& (= 1 (count @genders)) (all @genders 'female'))",conditions_expression:["&&",["=",1,["count","@genders"]],["all","@genders","female"]]},male:{description:"{token} contains 1 male",conditions:"(&& (= 1 (count @genders)) (all @genders 'male'))",conditions_expression:["&&",["=",1,["count","@genders"]],["all","@genders","male"]]},other:{description:"{token} contains at least 2 people"},unknown:{description:"{token} contains 1 person with unknown gender",conditions:"(&& (= 1 (count @genders)) (all @genders 'unknown'))",conditions_expression:["&&",["=",1,["count","@genders"]],["all","@genders","unknown"]]}},keys:["male","female","unknown","other"],default_key:"other",token_expression:"/.*(users|profiles|actors|targets)(\\d)*$/",variables:["@genders"],token_mapping:[{male:"{$0}",female:"{$0}",unknown:"{$0}",other:"{$0}"},{male:"{$0}",female:"{$0}",unknown:"{$0}",other:"{$1}"},{male:"{$0}",female:"{$1}",unknown:"{$0}/{$1}",other:"{$2}"},{male:"{$0}",female:"{$1}",unknown:"{$2}",other:"{$3}"}]}},cases:{times:{rules:[{description:"replace '1' with 'once'",conditions:"(= 1 @value)",conditions_expression:["=",1,"@value"],operations:"(replace '1' 'once' @value)",operations_expression:["replace","1","once","@value"]},{description:"replace '2' with 'twice'",conditions:"(= 2 @value)",conditions_expression:["=",2,"@value"],operations:"(replace '2' 'twice' @value)",operations_expression:["replace","2","twice","@value"]},{description:"in all other cases, append x times",conditions:"(true)",conditions_expression:["true"],operations:"(append ' times' @value)",operations_expression:["append"," times","@value"]}],latin_name:"Iteration",description:"The iteration form of the cardinal numbers",application:"phrase"},plural:{rules:[{description:"Uncountable word",conditions:"(in 'sheep,fish,series,species,money,rice,information,equipment' @value)",conditions_expression:["in","sheep,fish,series,species,money,rice,information,equipment","@value"],operations:"@value",operations_expression:"@value"},{description:"Irregular word",conditions:"(= 'move' @value)",conditions_expression:["=","move","@value"],operations:"(quote 'moves')",operations_expression:["quote","moves"]},{description:"Irregular word",conditions:"(= 'sex' @value)",conditions_expression:["=","sex","@value"],operations:"(quote 'sexes')",operations_expression:["quote","sexes"]},{description:"Irregular word",conditions:"(= 'child' @value)",conditions_expression:["=","child","@value"],operations:"(quote 'children')",operations_expression:["quote","children"]},{description:"Irregular word",conditions:"(= 'person' @value)",conditions_expression:["=","person","@value"],operations:"(quote 'people')",operations_expression:["quote","people"]},{conditions:"(match '/(quiz)$/i' @value)",conditions_expression:["match","/(quiz)$/i","@value"],operations:"(replace '/(quiz)$/i' '$1zes' @value)",operations_expression:["replace","/(quiz)$/i","$1zes","@value"]},{conditions:"(match '/^(ox)$/i' @value)",conditions_expression:["match","/^(ox)$/i","@value"],operations:"(replace '/^(ox)$/i' '$1en' @value)",operations_expression:["replace","/^(ox)$/i","$1en","@value"]},{conditions:"(match '/([m|l])ouse$/i' @value)",conditions_expression:["match","/([m|l])ouse$/i","@value"],operations:"(replace '/([m|l])ouse$/i' '$1ice' @value)",operations_expression:["replace","/([m|l])ouse$/i","$1ice","@value"]},{conditions:"(match '/(matr|vert|ind)ix|ex$/i' @value)",conditions_expression:["match","/(matr|vert|ind)ix|ex$/i","@value"],operations:"(replace '/(matr|vert|ind)ix|ex$/i' '$1ices' @value)",operations_expression:["replace","/(matr|vert|ind)ix|ex$/i","$1ices","@value"]},{conditions:"(match '/(x|ch|ss|sh)$/i' @value)",conditions_expression:["match","/(x|ch|ss|sh)$/i","@value"],operations:"(replace '/(x|ch|ss|sh)$/i' '$1es' @value)",operations_expression:["replace","/(x|ch|ss|sh)$/i","$1es","@value"]},{conditions:"(match '/([^aeiouy]|qu)y$/i' @value)",conditions_expression:["match","/([^aeiouy]|qu)y$/i","@value"],operations:"(replace '/([^aeiouy]|qu)y$/i' '$1ies' @value)",operations_expression:["replace","/([^aeiouy]|qu)y$/i","$1ies","@value"]},{conditions:"(match '/([^aeiouy]|qu)ies$/i' @value)",conditions_expression:["match","/([^aeiouy]|qu)ies$/i","@value"],operations:"(replace '/([^aeiouy]|qu)ies$/i' '$1y' @value)",operations_expression:["replace","/([^aeiouy]|qu)ies$/i","$1y","@value"]},{conditions:"(match '/(hive)$/i' @value)",conditions_expression:["match","/(hive)$/i","@value"],operations:"(replace '/(hive)$/i' '$1s' @value)",operations_expression:["replace","/(hive)$/i","$1s","@value"]},{conditions:"(match '/(?:([^f])fe|([lr])f)$/i' @value)",conditions_expression:["match","/(?:([^f])fe|([lr])f)$/i","@value"],operations:"(replace '/(?:([^f])fe|([lr])f)$/i' '$1$2ves' @value)",operations_expression:["replace","/(?:([^f])fe|([lr])f)$/i","$1$2ves","@value"]},{conditions:"(match '/sis$/i' @value)",conditions_expression:["match","/sis$/i","@value"],operations:"(replace '/sis$/i' 'ses' @value)",operations_expression:["replace","/sis$/i","ses","@value"]},{conditions:"(match '/([ti])um$/i' @value)",conditions_expression:["match","/([ti])um$/i","@value"],operations:"(replace '/([ti])um$/i' '$1a' @value)",operations_expression:["replace","/([ti])um$/i","$1a","@value"]},{conditions:"(match '/(buffal|tomat|potat)o$/i' @value)",conditions_expression:["match","/(buffal|tomat|potat)o$/i","@value"],operations:"(replace '/(buffal|tomat|potat)o$/i' '$1oes' @value)",operations_expression:["replace","/(buffal|tomat|potat)o$/i","$1oes","@value"]},{conditions:"(match '/(bu)s$/i' @value)",conditions_expression:["match","/(bu)s$/i","@value"],operations:"(replace '/(bu)s$/i' '$1ses' @value)",operations_expression:["replace","/(bu)s$/i","$1ses","@value"]},{conditions:"(match '/(alias|status)$/i' @value)",conditions_expression:["match","/(alias|status)$/i","@value"],operations:"(replace '/(alias|status)$/i' '$1es' @value)",operations_expression:["replace","/(alias|status)$/i","$1es","@value"]},{conditions:"(match '/(octop)us$/i' @value)",conditions_expression:["match","/(octop)us$/i","@value"],operations:"(replace '/(octop)us$/i' '$1i' @value)",operations_expression:["replace","/(octop)us$/i","$1i","@value"]},{conditions:"(match '/(ax|test)is$/i' @value)",conditions_expression:["match","/(ax|test)is$/i","@value"],operations:"(replace '/(ax|test)is$/i' '$1es' @value)",operations_expression:["replace","/(ax|test)is$/i","$1es","@value"]},{conditions:"(match '/us$/i' @value)",conditions_expression:["match","/us$/i","@value"],operations:"(replace '/us$/i' '$1es' @value)",operations_expression:["replace","/us$/i","$1es","@value"]},{conditions:"(match '/s$/i' @value)",conditions_expression:["match","/s$/i","@value"],operations:"(replace '/s$/i' 's' @value)",operations_expression:["replace","/s$/i","s","@value"]},{conditions:"(match '/$/' @value)",conditions_expression:["match","/$/","@value"],operations:"(replace '/$/' 's' @value)",operations_expression:["replace","/$/","s","@value"]}],latin_name:"Plural",description:"Converts singular form to plural",application:"phrase"},ordinal:{rules:[{description:"replace 1 with 'first'",conditions:"(= 1 @value)",conditions_expression:["=",1,"@value"],operations:"(replace 1 'first' @value)",operations_expression:["replace",1,"first","@value"]},{description:"replace 2 with 'second'",conditions:"(= 2 @value)",conditions_expression:["=",2,"@value"],operations:"(replace 2 'first' @value)",operations_expression:["replace",2,"first","@value"]},{description:"replace 3 with 'third'",conditions:"(= 3 @value)",conditions_expression:["=",3,"@value"],operations:"(replace 3 'third' @value)",operations_expression:["replace",3,"third","@value"]}],latin_name:"Ordinal",description:"The adjective form of the cardinal numbers",application:"phrase"},ord:{rules:[{description:"append 'st' if value ends in 1, but not in 11",examples:"1, 21, 31, 41, 101, 121...",conditions:"(&& (match '/1$/' @value) (! (match '/11$/' @value)))",conditions_expression:["&&",["match","/1$/","@value"],["!",["match","/11$/","@value"]]],operations:"(append 'st' @value)",operations_expression:["append","st","@value"]},{description:"append 'nd' if value ends in 2, but not in 12",examples:"2, 22, 32, 42, 102, 122...",conditions:"(&& (match '/2$/' @value) (! (match '/12$/' @value)))",conditions_expression:["&&",["match","/2$/","@value"],["!",["match","/12$/","@value"]]],operations:"(append 'nd' @value)",operations_expression:["append","nd","@value"]},{description:"append 'nd' if value ends in 3, but not in 13",examples:"3, 23, 33, 43, 103, 123...",conditions:"(&& (match '/3$/' @value) (! (match '/13$/' @value)))",conditions_expression:["&&",["match","/3$/","@value"],["!",["match","/13$/","@value"]]],operations:"(append 'rd' @value)",operations_expression:["append","rd","@value"]},{description:"append 'th' in all other cases",examples:"0, 4, 5, 6, 7, 8, 9, 11, 12, 13, 111, 113...",conditions:"(true)",conditions_expression:["true"],operations:"(append 'th' @value)",operations_expression:["append","th","@value"]}],latin_name:"Ordinal",description:"The adjective form of the cardinal numbers",application:"phrase"},singular:{rules:[{description:"Uncountable word",conditions:"(in 'sheep,fish,series,species,money,rice,information,equipment' @value)",conditions_expression:["in","sheep,fish,series,species,money,rice,information,equipment","@value"],operations:"@value",operations_expression:"@value"},{description:"Irregular word",conditions:"(= 'moves' @value)",conditions_expression:["=","moves","@value"],operations:"(quote 'move')",operations_expression:["quote","move"]},{description:"Irregular word",conditions:"(= 'sexes' @value)",conditions_expression:["=","sexes","@value"],operations:"(quote 'sex')",operations_expression:["quote","sex"]},{description:"Irregular word",conditions:"(= 'children' @value)",conditions_expression:["=","children","@value"],operations:"(quote 'child')",operations_expression:["quote","child"]},{description:"Irregular word",conditions:"(= 'people' @value)",conditions_expression:["=","people","@value"],operations:"(quote 'person')",operations_expression:["quote","person"]},{conditions:"(match '/(n)ews$/i' @value)",conditions_expression:["match","/(n)ews$/i","@value"],operations:"(replace '/(n)ews$/i' '$1ews' @value)",operations_expression:["replace","/(n)ews$/i","$1ews","@value"]},{conditions:"(match '/([ti])a$/i' @value)",conditions_expression:["match","/([ti])a$/i","@value"],operations:"(replace '/([ti])a$/i' '$1um' @value)",operations_expression:["replace","/([ti])a$/i","$1um","@value"]},{conditions:"(match '/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i' @value)",conditions_expression:["match","/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i","@value"],operations:"(replace '/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i' '$1$2sis' @value)",operations_expression:["replace","/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i","$1$2sis","@value"]},{conditions:"(match '/(^analy)ses$/i' @value)",conditions_expression:["match","/(^analy)ses$/i","@value"],operations:"(replace '/(^analy)ses$/i' '$1sis' @value)",operations_expression:["replace","/(^analy)ses$/i","$1sis","@value"]},{conditions:"(match '/([^f])ves$/i' @value)",conditions_expression:["match","/([^f])ves$/i","@value"],operations:"(replace '/([^f])ves$/i' '$1fe' @value)",operations_expression:["replace","/([^f])ves$/i","$1fe","@value"]},{conditions:"(match '/(hive)s$/i' @value)",conditions_expression:["match","/(hive)s$/i","@value"],operations:"(replace '/(hive)s$/i' '$1' @value)",operations_expression:["replace","/(hive)s$/i","$1","@value"]},{conditions:"(match '/(tive)s$/i' @value)",conditions_expression:["match","/(tive)s$/i","@value"],operations:"(replace '/(tive)s$/i' '$1' @value)",operations_expression:["replace","/(tive)s$/i","$1","@value"]},{conditions:"(match '/([lr])ves$/i' @value)",conditions_expression:["match","/([lr])ves$/i","@value"],operations:"(replace '/([lr])ves$/i' '$1f' @value)",operations_expression:["replace","/([lr])ves$/i","$1f","@value"]},{conditions:"(match '/([^aeiouy]|qu)ies$/i' @value)",conditions_expression:["match","/([^aeiouy]|qu)ies$/i","@value"],operations:"(replace '/([^aeiouy]|qu)ies$/i' '$1y' @value)",operations_expression:["replace","/([^aeiouy]|qu)ies$/i","$1y","@value"]},{conditions:"(match '/(s)eries$/i' @value)",conditions_expression:["match","/(s)eries$/i","@value"],operations:"(replace '/(s)eries$/i' '$1eries' @value)",operations_expression:["replace","/(s)eries$/i","$1eries","@value"]},{conditions:"(match '/(m)ovies$/i' @value)",conditions_expression:["match","/(m)ovies$/i","@value"],operations:"(replace '/(m)ovies$/i' '$1ovie' @value)",operations_expression:["replace","/(m)ovies$/i","$1ovie","@value"]},{conditions:"(match '/(x|ch|ss|sh)es$/i' @value)",conditions_expression:["match","/(x|ch|ss|sh)es$/i","@value"],operations:"(replace '/(x|ch|ss|sh)es$/i' '$1' @value)",operations_expression:["replace","/(x|ch|ss|sh)es$/i","$1","@value"]},{conditions:"(match '/([m|l])ice$/i' @value)",conditions_expression:["match","/([m|l])ice$/i","@value"],operations:"(replace '/([m|l])ice$/i' '$1ouse' @value)",operations_expression:["replace","/([m|l])ice$/i","$1ouse","@value"]},{conditions:"(match '/(bus)es$/i' @value)",conditions_expression:["match","/(bus)es$/i","@value"],operations:"(replace '/(bus)es$/i' '$1' @value)",operations_expression:["replace","/(bus)es$/i","$1","@value"]},{conditions:"(match '/(o)es$/i' @value)",conditions_expression:["match","/(o)es$/i","@value"],operations:"(replace '/(o)es$/i' '$1' @value)",operations_expression:["replace","/(o)es$/i","$1","@value"]},{conditions:"(match '/(shoe)s$/i' @value)",conditions_expression:["match","/(shoe)s$/i","@value"],operations:"(replace '/(shoe)s$/i' '$1' @value)",operations_expression:["replace","/(shoe)s$/i","$1","@value"]},{conditions:"(match '/(cris|ax|test)es$/i' @value)",conditions_expression:["match","/(cris|ax|test)es$/i","@value"],operations:"(replace '/(cris|ax|test)es$/i' '$1is' @value)",operations_expression:["replace","/(cris|ax|test)es$/i","$1is","@value"]},{conditions:"(match '/(octop|vir)i$/i' @value)",conditions_expression:["match","/(octop|vir)i$/i","@value"],operations:"(replace '/(octop|vir)i$/i' '$1us' @value)",operations_expression:["replace","/(octop|vir)i$/i","$1us","@value"]},{conditions:"(match '/(alias|status)es$/i' @value)",conditions_expression:["match","/(alias|status)es$/i","@value"],operations:"(replace '/(alias|status)es$/i' '$1' @value)",operations_expression:["replace","/(alias|status)es$/i","$1","@value"]},{conditions:"(match '/^(ox)en$/i' @value)",conditions_expression:["match","/^(ox)en$/i","@value"],operations:"(replace '/^(ox)en$/i' '$1' @value)",operations_expression:["replace","/^(ox)en$/i","$1","@value"]},{conditions:"(match '/(vert|ind)ices$/i' @value)",conditions_expression:["match","/(vert|ind)ices$/i","@value"],
operations:"(replace '/(vert|ind)ices$/i' '$1ex' @value)",operations_expression:["replace","/(vert|ind)ices$/i","$1ex","@value"]},{conditions:"(match '/(matr)ices$/i' @value)",conditions_expression:["match","/(matr)ices$/i","@value"],operations:"(replace '/(matr)ices$/i' '$1ix' @value)",operations_expression:["replace","/(matr)ices$/i","$1ix","@value"]},{conditions:"(match '/(quiz)zes$/i' @value)",conditions_expression:["match","/(quiz)zes$/i","@value"],operations:"(replace '/(quiz)zes$/i' '$1' @value)",operations_expression:["replace","/(quiz)zes$/i","$1","@value"]},{conditions:"(match '/(us)es$/i' @value)",conditions_expression:["match","/(us)es$/i","@value"],operations:"(replace '/(us)es$/i' '$1' @value)",operations_expression:["replace","/(us)es$/i","$1","@value"]},{conditions:"(match '/s$/i' @value)",conditions_expression:["match","/s$/i","@value"],operations:"(replace '/s$/i' '' @value)",operations_expression:["replace","/s$/i","","@value"]}],latin_name:"Singular",description:"Converts plural form to singular",application:"phrase"},pos:{rules:[{description:"if value ends in s, append '",conditions:"(match '/s$/' @value)",conditions_expression:["match","/s$/","@value"],operations:'(append "\'" @value)',operations_expression:["append","'","@value"]},{description:"in all other cases, append 's",conditions:"(true)",conditions_expression:["true"],operations:'(append "\'s" @value)',operations_expression:["append","'s","@value"]}],latin_name:"Possessive",description:"Used to indicate possession (i.e., ownership). It is usually created by adding 's to the word",application:"phrase"}}}},{}],16:[function(a,b,c){var d=function(){};d.prototype={get:function(a,b,c){throw new Error("Must be implemented by the extending class")},post:function(a,b,c){throw new Error("Must be implemented by the extending class")}},b.exports=d},{}],17:[function(a,b,c){var d=a("./logger"),e=a("./utils"),f=a("./configuration"),g=a("./api_adapters/base"),h="/v1/",i=function(a){this.application=a,this.cache=f.getCache();var b=f.getApiAdapter(f.api);b.prototype=e.extend(new g,b.prototype),this.adapter=new b};i.prototype={normalizeParams:function(a,b,c,d){return e.isFunction(b)?(d=b,b={}):e.isFunction(c)&&(d=c,c={}),c=c||{},{path:a,params:b,options:c,callback:d}},getReleaseVersion:function(a){var b=this,c=(new Date).getTime(),d=this.application.getCdnHost()+"/"+this.application.key+"/version.json";b.adapter.get(d,{t:c},function(b,c,d){if(403==c.status||b||!d)a("0");else try{d=JSON.parse(d),a(d.version)}catch(e){a("0")}})},updateReleaseVersion:function(a,b){var c=this;c.getReleaseVersion(function(e){c.cache.storeVersion(e,function(e){a!=e&&(d.debug("Changing version from "+a+" to "+e),c.cache.clear()),b(e)})})},getCacheVersion:function(a){if(this.cache.version&&"undefined"!=this.cache.version)return void a(this.cache.version);var b=this;this.cache.fetchVersion(function(c){var e=!1;if(c.t){var f=c.t+b.cache.getVersionCheckInterval(),g=(new Date).getTime();if(g>f)d.debug("Cache version is outdated and needs a refresh now"),e=!0;else{var h=Math.round((f-g)/1e3);d.debug("Cache version is up to date, will be checked in: "+h+"s")}}else d.debug("Cache version has no timestamp, needs a refresh"),e=!0;e?b.updateReleaseVersion(c.version,function(b){a(b)}):(b.cache.setVersion(c.version),a(c.version))})},fetchFromCdn:function(a,b){var c=this;if("0"==c.cache.version)return void b(null,null);var d=this.application.getCdnHost()+"/"+this.application.key+"/"+this.cache.version+e.normalizePath(a)+".json";c.adapter.get(d,{},function(a,c,d){(!d||d.match(/xml/))&&(a="Not found"),a||!d?b(a,null):b(null,d)})},get:function(a,b,c,d){var e=this.normalizeParams(a,b,c,d);e.options.method="get",this.api(e.path,e.params,e.options,e.callback)},post:function(a,b,c,d){var e=this.normalizeParams(a,b,c,d);e.options.method="post",this.api(e.path,e.params,e.options,e.callback)},isLiveApiRequest:function(){return this.application.token?this.application.isInlineModeEnabled():!1},isCacheEnabled:function(a){return"post"==a.method?!1:a.cache_key&&this.cache},api:function(a,b,c,d){e.extend(b,{access_token:this.application.token});var f=this.application.getHost()+h+a,g=this,i=function(a,b,c){!a&&c?d(a,JSON.parse(c)):d(a,c)};return g.isLiveApiRequest()?void("post"==c.method?g.adapter.post(f,b,i):g.adapter.get(f,b,i)):g.isCacheEnabled(c)?void g.getCacheVersion(function(a){0===parseInt(a)?i("No release has been published"):g.cache.fetch(c.cache_key,function(a){g.fetchFromCdn(c.cache_key,a)},function(a,b){if(!a&&b){try{b=JSON.parse(b)}catch(c){return d(c)}d(null,b)}else d(a)})}):void i("Cache is disabled")}},b.exports=i},{"./api_adapters/base":16,"./configuration":21,"./logger":29,"./utils":44}],18:[function(a,b,c){var d=a("./utils"),e=a("./configuration"),f=a("./logger"),g=a("./language"),h=a("./source"),i=a("./api_client"),j="https://api.translationexchange.com",k="https://cdn.translationexchange.com",l=function(a){d.extend(this,a),this.languages=[];for(var b in a.languages||[])this.languages.push(new g(d.extend(b,{application:this})));this.default_locale=e.default_locale,this.languages_by_locale={},this.sources_by_key={},this.missing_keys_by_source={},this.translation_keys={}};l.prototype={getHost:function(){return this.host||j},getCdnHost:function(){return this.cdn_host||k},extend:function(a){d.extend(this,a)},addLanguage:function(a){return a.application=this,this.languages_by_locale[a.locale]=new g(a),this.getLanguage(a.locale)},getLanguage:function(a){var b=this.languages_by_locale[a];return b&&(b.application=this),b},changeLanguage:function(a,b){var c=this;c.current_locale=a,c.sources_by_key={},this.initData([c.current_locale],[c.current_source],function(){b&&b(c.getLanguage(c.current_locale))})},getCurrentLanguage:function(){var a=this.current_locale;if(!a)return this.getDefaultLanguage();var b=this.getLanguage(a);return b?b:(a=a.split("-")[0],b=this.getLanguage(a),b||this.getDefaultLanguage())},getDefaultLanguage:function(){var a=this.getLanguage(this.default_locale);return a=a||new g(e.getDefaultLanguage()),a.application=this,a},addSource:function(a,b,c){return a?(a=new h({source:a}),a.application=this,a.updateTranslations(b,c),this.sources_by_key[a.source]=a,this.getSource(a.source)):void 0},getSource:function(a){return this.sources_by_key[a]},removeSource:function(a){delete this.sources_by_key[a]},getCurrentSource:function(){return this.current_source?this.sources_by_key[this.current_source]:null},isFeatureEnabled:function(a){return this.features&&this.features[a]},getApiClient:function(){return this.api_client||(this.api_client=new i(this)),this.api_client},init:function(a,b){a=a||{};var c=this;c.current_translator=a.current_translator,c.current_source=a.current_source,d.isFunction(c.current_source)&&(c.current_source=c.current_source()),c.getApiClient().get("projects/"+c.key+"/definition",{locale:a.current_locale||(a.accepted_locales?a.accepted_locales.join(","):"en"),source:c.current_source,ignored:!0},{cache_key:"application"},function(d,f){if(c.default_locale=c.default_locale||"en",d)return c.extend(e.getDefaultApplication()),c.addLanguage(e.getDefaultLanguage()),void b(null);c.extend(f),c.loadExtension(f),c.current_locale=a.current_locale||c.getPreferredLocale(a.accepted_locales,c.languages)||c.default_locale,c.isSupportedLocale(c.current_locale)||(c.current_locale=c.default_locale);var g=[c.default_locale];c.current_locale!=c.default_locale&&g.push(c.current_locale);var h=[c.current_source||"index"];c.initData(g,h,b)})},isSupportedLocale:function(a){if(!this.languages)return!1;for(var b=0;b<this.languages.length;b++)if(this.languages[b].locale==a)return!0;return!1},loadExtension:function(a){if(a=a.extensions){var b=this,c=b.default_locale,d=e.getCache();b.isInlineModeEnabled()&&(d=null),a.languages&&Object.keys(a.languages).forEach(function(e){e!=b.default_locale&&(c=e),d&&d.store(b.getLanguageKey(e),JSON.stringify(a.languages[e])),b.addLanguage(new g(a.languages[e]))}),a.sources&&Object.keys(a.sources).forEach(function(e){d&&d.store(b.getSourceKey(e,c),JSON.stringify(a.sources[e])),b.addSource(e,c,a.sources[e])})}},initData:function(a,b,c){var d=this;d.loadLanguages(a,function(){b?d.loadSources(b,d.current_locale,function(a){a.length>0&&a[0]&&a[0].sources&&a[0].sources.length>0?d.loadSources(a[0].sources,d.current_locale,function(a){c(null)}):c(null)}):c(null)})},getPreferredLocale:function(a,b){var c,d=(b||[]).map(function(a){return a.locale});return(a||[]).forEach(function(a){var b=new RegExp(a+"|"+a.replace(/-\w+$/,""));d.forEach(function(a){!c&&a.match(b)&&(c=a)})}),c},loadLanguages:function(a,b){var c={},e=this;a.forEach(function(a){e.languages_by_locale[a]||(c[a]=function(b){e.getApiClient().get("languages/"+a+"/definition",{},{cache_key:e.getLanguageKey(a)},function(a,c){return a?void b(a,null):void b(null,new g(d.extend(c,{application:e})))})})}),d.parallel(c,function(a,c){if(a)throw console.log(a),a;Object.keys(c).forEach(function(a){e.addLanguage(c[a])}),b()})},getLanguageKey:function(a){return a+"/language"},getSourceKey:function(a,b){return b+"/sources/"+a},getSourceName:function(a){return a.call&&a()||a},loadSources:function(a,b,c){var e={},f=this;a.forEach(function(a){a=f.getSourceName(a),f.sources_by_key[a]||(e[a]=function(c){var e=d.generateSourceKey(a);f.getApiClient().get("sources/"+e+"/translations",{locale:b,ignored:!0,all:!0,app_id:f.key},{cache_key:b+"/sources"+d.normalizePath(a)},function(a,b){return a?void c(a,null):void c(null,b)})})}),d.parallel(e,function(a,d){var e=[];d&&Object.keys(d).forEach(function(a){e.push(d[a]),f.addSource(a,b,d[a])}),c(e)})},isInlineModeEnabled:function(){return this.current_translator?this.current_translator.inline:!1},addMissingElement:function(a,b){(!e.isFileCache()||this.isInlineModeEnabled())&&(this.missing_keys_by_source||(this.missing_keys_by_source={}),this.missing_keys_by_source[a]||(this.missing_keys_by_source[a]={}),null!==b&&(this.missing_keys_by_source[a][b.key]=b))},verifySourcePath:function(a,b){this.extensions&&this.extensions.sources&&null===this.extensions.sources[a]&&this.addMissingElement(b,null)},registerMissingTranslationKey:function(a,b){this.addMissingElement(a,b);var c=this;e.delayed_flush&&!c.submit_scheduled&&(c.submit_scheduled=!0,setTimeout(function(){c.submitMissingTranslationKeys()},3e3))},submitMissingTranslationKeys:function(a){if(!this.missing_keys_by_source)return void(a&&a(!1));if(!this.isInlineModeEnabled())return void(a&&a(!1));var b=d.keys(this.missing_keys_by_source);if(0===b.length)return void(a&&a(!1));f.debug("Submitting missing translation keys...");for(var c=[],g=["key","label","description","locale","level"],h=0;h<b.length;h++){for(var i=b[h],j=d.keys(this.missing_keys_by_source[i]),k=[],l=0;l<j.length;l++){for(var m=this.missing_keys_by_source[i][j[l]],n={},o=0;o<g.length;o++){var p=g[o];m[p]&&(n[p]=m[p])}k.push(n)}c.push({source:i,keys:k})}var q=this;q.missing_keys_by_source=null,this.getApiClient().post("sources/register_keys",{source_keys:JSON.stringify(c),app_id:q.key},function(){d.keys(q.languages_by_locale).forEach(function(a){b.forEach(function(b){b=b.split(e.source_separator),b.forEach(function(b){q.removeSource(b),e.getCache().del(a+"/sources/"+b,function(){})})})}),a&&a(!0)})},getTranslationKey:function(a){return this.translation_keys[a]},cacheTranslationKey:function(a){var b=this.getTranslationKey(a.key);if(b){for(var c=d.keys(a.translations||{}),e=0;e<c.length;e++){var f=a.translations[c[e]],g=this.getLanguage(c[e]);b.setTranslationsForLanguage(g,f)}return b}return a.setApplication(this),this.translation_keys[a.key]=a,a}},b.exports=l},{"./api_client":17,"./configuration":21,"./language":24,"./logger":29,"./source":33,"./utils":44}],19:[function(a,b,c){var d=a("./utils"),e=a("./cache_adapters/base"),f=function(b){this.adapter=null,this.options=b,this.version=b.version;var c;if(b){if("string"==typeof b.adapter){var f=a("./configuration");c=f.getCacheAdapter(b.adapter)}else"function"==typeof b.adapter&&(c=b.adapter,delete b.adapter);c&&(c.prototype=d.extend(new e,c.prototype),this.adapter=new c(b),b.version_check_interval&&(this.adapter.version_check_interval=b.version_check_interval))}};f.prototype={fetch:function(a,b,c){return this.adapter?void this.adapter.fetch(a,b,c):void(d.isFunction(b)?b(function(a,b){b?c(null,b):c("no data",null)}.bind(this)):c(null,b))},store:function(a,b,c){return this.adapter?void this.adapter.store(a,b,c):void(d.isFunction(c)&&c())},del:function(a,b){return this.adapter?void this.adapter.del(a,b):void b()},exists:function(a,b){return this.adapter?void this.adapter.exists(a,b):void b()},fetchVersion:function(a){return this.adapter?void this.adapter.fetchVersion(a):void a({version:this.options.version||"0"})},storeVersion:function(a,b){return this.version=a,this.adapter?void this.adapter.storeVersion(a,b):void(b&&b(a))},setVersion:function(a){this.version=a,this.adapter&&(this.adapter.version=a)},resetVersion:function(){this.adapter&&(this.version=null)},getVersionCheckInterval:function(){return this.adapter?1e3*this.adapter.version_check_interval:0},clear:function(a){return this.adapter?void this.adapter.clear(a):void(a&&a())}},b.exports=f},{"./cache_adapters/base":20,"./configuration":21,"./utils":44}],20:[function(a,b,c){var d=(a("../configuration"),a("../logger")),e=a("../utils"),f="current_version",g="tml",h=function(){};h.prototype={read_only:!0,cached_by_source:!0,name:"",version_check_interval:3600,initialize:function(a){this.config=a||{},this.cache=this.create()},create:function(){d.debug("Must be implemented by the extending class")},fetch:function(){d.debug("Must be implemented by the extending class")},store:function(a,b){d.debug("Must be implemented by the extending class")},del:function(a){d.debug("Must be implemented by the extending class")},exists:function(a){d.debug("Must be implemented by the extending class")},warn:function(a){d.debug(this.name+" - "+a)},info:function(a){d.debug(this.name+" - "+a)},fileName:function(a){return a+".json"},fetchDefault:function(a,b,c){var d=this;e.isFunction(b)?b(function(b,e){e?d.store(a,e,function(){c(null,e)}):c("no data",null)}.bind(this)):b&&d.store(a,b,function(a,b){c(null,b)})},fetchVersion:function(a){var b=this;if(b.config.version)b.info("Cache version from config: "+b.config.version),a(b.config.version);else{var c=JSON.stringify({version:"undefined"});b.fetch(f,c,function(c,d){d=d||"",d=-1!=d.indexOf("{")?JSON.parse(d):{version:d},b.info("Cache version: "+d.version),a(d)})}},storeVersion:function(a,b){var c=this;c.version=a;var d=JSON.stringify({version:c.version,t:c.getVersionTimestamp()});c.store(f,d,function(){b&&b(c.version)})},getVersionTimestamp:function(){var a=(new Date).getTime();return a},getVersionedKey:function(a){var b=[g,this.config.namespace||"",a==f?"v":"v"+(this.version||this.config.version||"0"),a];return b.join("_")},stripExtensions:function(a){return e.isString(a)&&a.match(/^\{/)&&(a=JSON.parse(a),a.extensions&&delete a.extensions,a=JSON.stringify(a)),a},getRequest:function(){return null},clear:function(a){a&&a(null)}},b.exports=h},{"../configuration":21,"../logger":29,"../utils":44}],21:[function(a,b,c){var d=a("./cache"),e=a("./utils"),f=a("./../config/defaults.js"),g=a("./../config/english.js"),h=a("./../config/application.js"),i=function(){e.merge(this,f)};i.prototype={initCache:function(a){return this.cache=this.cache||{},a&&(this.cache.namespace=a.substring(0,5)),this.cacheAdapter=new d(this.cache),this.cacheAdapter},getDefaultApplication:function(){return h},getDefaultLanguage:function(){return g},getCache:function(){return this.cacheAdapter},getDefaultToken:function(a,b,c){if(b=b||"data",c=c||"html",this.default_tokens[c][b][a])return this.default_tokens[c][b][a];var d=a.split("_");return a=d[d.length-1],a=a.replace(/_*\d+$/,""),this.default_tokens[c][b][a]?this.default_tokens[c][b][a]:null},setDefaultToken:function(a,b,c,d){c=c||"data",d=d||"html",this.default_tokens[d]=this.default_tokens[d]||{},this.default_tokens[d][c]=this.default_tokens[d][c]||{},this.default_tokens[d][c][a]=b},getContextRules:function(a){return this.context_rules[a]||{}},setContextRules:function(a,b,c){return this.context_rules[a]?void(this.context_rules[a].variables[b]=c):!1},isDisabled:function(){return!this.isEnabled()},isEnabled:function(){return this.enabled},isFileCache:function(){return null===this.cache?!1:"file"==this.cache.adapter},registerCacheAdapter:function(a,b){this.cache_adapters=this.cache_adapters||{},this.cache_adapters[a]=b},registerCacheAdapters:function(a){var b=this;Object.keys(a).forEach(function(c){b.registerCacheAdapter(c,a[c])})},getCacheAdapter:function(a){return this.cache_adapters?this.cache_adapters[a]:null},registerApiAdapter:function(a,b){this.api_adapters=this.api_adapters||{},this.api_adapters[a]=b},registerApiAdapters:function(a){var b=this;Object.keys(a).forEach(function(c){b.registerApiAdapter(c,a[c][klass])})},getApiAdapter:function(a){return this.api_adapters?this.api_adapters[a]:null}},b.exports=new i},{"./../config/application.js":13,"./../config/defaults.js":14,"./../config/english.js":15,"./cache":19,"./utils":44}],22:[function(a,b,c){(function(c){var d=a("../utils"),e={isEnabled:function(a){return a?a.skip_decorations?!1:a.ignored?!1:a.current_translator&&a.current_translator.inline:!1},getDecorationElement:function(a,b){return b.use_span?"span":b.use_div?"div":a},decorate:function(a,b,c,d,e){if(e=e||{},!this.isEnabled(e))return a;if(d.application&&d.application.isFeatureEnabled("lock_original_content")&&d.language==c||d.locked&&!e.current_translator.manager)return a;var f=this.getDecorationElement("tml:label",e),g=["tml_translatable"];if(e.locked){if(e.current_translator&&!e.current_translator.isFeatureEnabled("show_locked_keys"))return a;g.push("tml_locked")}else b.locale===d.locale?e.pending?g.push("tml_pending"):g.push("tml_not_translated"):b.locale===c.locale?g.push("tml_translated"):g.push("tml_fallback");var h=[];return h.push("<"+f+" class='"+g.join(" ")+"' data-translation_key='"+d.key+"' data-target_locale='"+c.locale+"'>"),h.push(a),h.push("</"+f+">"),h.join("")},decorateLanguageCase:function(a,b,e,f,g){if(g=g||{},!this.isEnabled(g))return f;for(var h={keyword:a.keyword,language_name:a.language.english_name,latin_name:a.latin_name,native_name:a.native_name,conditions:b?b.conditions:"",operations:b?b.operations:"",original:e,transformed:f},i=new c(JSON.stringify(h)).toString("base64").trim().replace("\n",""),j={"class":"tml_language_case","data-locale":a.language.locale,"data-rule":encodeURIComponent(i)},k=[],l=d.keys(j),m=0;m<l.length;m++)k.push(""+l[m]+'="'+j[l[m]]+'"');var n=this.getDecorationElement("tml:case",g),o=[];return o.push("<"+n+" "+k.join(" ")+">"),o.push(f),o.push("</"+n+">"),o.join("")},decorateToken:function(a,b,c){if(!this.isEnabled(c))return b;var d=this.getDecorationElement("tml:token",c),e=["tml_token","tml_token_"+a.getDecorationName()],f=[];return f.push("<"+d+" class='"+e.join(" ")+"' data-name='"+a.short_name+"'"),a.context_keys&&a.context_keys.length>0&&f.push(" data-context='"+a.context_keys.join(",")+"'"),a.case_keys&&a.case_keys.length>0&&f.push(" data-case='"+a.case_keys.join(",")+"'"),f.push(">"),f.push(b),f.push("</"+d+">"),f.join("")},decorateElement:function(a,b,c){if(!this.isEnabled(c))return b;var d=this.getDecorationElement("tml:element",c),e=[];return e.push("<"+d+">"),e.push(b),e.push("</"+d+">"),e.join("")}};b.exports=e}).call(this,a("buffer").Buffer)},{"../utils":44,buffer:8}],23:[function(a,b,c){var d={agent_tag:function(a,b){b=b||{},b.cache=b.cache||864e6;var c=b.host||"https://tools.translationexchange.com/agent/stable/agent.min.js";if(b.cache){var d=(new Date).getTime();d-=d%b.cache,c+="?ts="+d}b.css=b.css||a.css,b.sdk=b.sdk||"tml-js v0.4.16",b.languages=[];for(var e=0;e<a.languages.length;e++){var f=a.languages[e];b.languages.push({locale:f.locale,english_name:f.english_name,native_name:f.native_name,flag_url:f.flag_url})}var g=[];return g.push("<script>"),g.push("(function() {"),g.push("  var script = document.createElement('script');"),g.push("  script.setAttribute('id', 'tml-agent'); script.setAttribute('type', 'application/javascript');"),g.push("  script.setAttribute('src', '"+c+"');"),g.push("  script.setAttribute('charset', 'UTF-8');"),g.push("  script.onload = function() {"),g.push("       Trex.init('"+a.key+"', "+JSON.stringify(b)+");"),g.push("  };"),g.push("  document.getElementsByTagName('head')[0].appendChild(script);"),g.push("})();"),g.push("</script>"),g.join("\n")},language_name_tag:function(a,b){b=b||{},null===a&&(a=tml_current_language());var c=[];return b.flag&&(c.push(this.language_flag_tag(a)),c.push(" ")),c.push(a.native_name),c.join("")},language_flag_tag:function(a,b){b=b||{};var c=a.english_name;return"native"==b.language&&(c=a.native_name),null===a&&(a=tml_current_language()),"<img src='"+a.flag_url+"' style='margin-right:3px;' alt='"+c+"' title='"+c+"'>"},language_selector_tag:function(a,b,c){b=b||"default";for(var d=[],e=Object.keys(c),f=1;f<e.length;f++)d.push("data-tml-"+e[f]+"='"+c[e[f]]+"'");return d=d.join(" "),"<div data-tml-language-selector='"+b+"' "+d+"></div>"}};b.exports={header:d.agent_tag,agent_tag:d.agent_tag,language_name_tag:d.language_name_tag,language_flag_tag:d.language_flag_tag,language_selector:d.language_selector_tag}},{}],24:[function(a,b,c){var d=a("./utils"),e=a("./configuration"),f=a("./language_context"),g=a("./language_case"),h=a("./translation_key"),i=function(a){d.extend(this,a),this.contexts={};for(var b=d.keys(a.contexts||{}),c=0;c<b.length;c++)this.contexts[b[c]]=new f(d.extend(a.contexts[b[c]],{language:this,keyword:b[c]}));for(this.cases={},b=d.keys(a.cases||{}),c=0;c<b.length;c++)this.cases[b[c]]=new g(d.extend(a.cases[b[c]],{language:this,keyword:b[c]}))};i.prototype={getContextByKeyword:function(a){return this.contexts[a]},getContextByTokenName:function(a){for(var b=d.keys(this.contexts||{}),c=0;c<b.length;c++)if(this.contexts[b[c]].isAppliedToToken(a))return this.contexts[b[c]];return null},getLanguageCaseByKeyword:function(a){return this.cases[a]},isDefault:function(){return this.locale==e.default_locale},translate:function(a,b,c,f){var g=d.normalizeParams(a,b,c,f),i=new h({label:g.label,description:g.description,language:this.application?this.application.getLanguage():null,application:this.application});if(this.application){var j=this.getSourcePath(g.options),k=j[j.length-1];j=j.join(e.source_separator),g.options.block_options&&g.options.block_options.dynamic?j=k:this.application.verifySourcePath(k,j);var l=this.application.getSource(k);if(l&&l.isIgnoredKey(i.key))return g.options.ignored=!0,i.translate(this,g.tokens,g.options);var m=l?l.getTranslations(this.locale,i.key):null;if(m)i.setTranslations(this.locale,m);else{g.options.pending=!0,this.application.registerMissingTranslationKey(j,i);var n=this.application.getTranslationKey(i.key);n&&(i=n)}}return i.translate(this,g.tokens,g.options)},align:function(a){return this.isRightToLeft()?"left"==a?"right":"left":a},isRightToLeft:function(){return this.right_to_left},direction:function(){return this.isRightToLeft()?"rtl":"ltr"},getSourceName:function(a){var b=a.call&&a()||a;return b&&b.length>60&&(b=b.substring(0,60)),b},getSourcePath:function(a){if(!a.block_options.length)return[this.getSourceName(a.current_source)];for(var b=[],c=0;c<a.block_options.length;c++){var d=a.block_options[c];d.source&&b.push(this.getSourceName(d.source))}return b=b.reverse(),b.unshift(this.getSourceName(a.current_source)),b}},b.exports=i},{"./configuration":21,"./language_case":25,"./language_context":27,"./translation_key":42,"./utils":44}],25:[function(a,b,c){var d=a("./utils"),e=a("./configuration"),f=a("./language_case_rule"),g=a("./decorators/html"),h=function(a){d.extend(this,a),this.rules=[],a.rules=a.rules||[];for(var b=0;b<a.rules.length;b++)this.rules.push(new f(d.extend(a.rules[b],{language_case:this})))};h.prototype={findMatchingRule:function(a,b){for(var c=0;c<this.rules.length;c++){var d=this.rules[c];if(d.evaluate(a,b))return d}return null},apply:function(a,b,c){var e=d.unique(a.match(/<\/?[^>]*>/g)||[]),f=a.replace(/<\/?[^>]*>/g,""),h=[f];"phrase"!=this.application&&(h=d.unique(f.split(/[\s\/]/)||[]));for(var i=0;i<e.length;i++)a=a.replace(e[i],"{$h"+i+"}");for(i=0;i<h.length;i++)a=a.replace(h[i],"{$w"+i+"}");var j=g,k=[];for(i=0;i<h.length;i++){var l=h[i],m=this.findMatchingRule(l,b),n=m?m.apply(l):l;k.push(j.decorateLanguageCase(this,m,l,n,c))}for(i=0;i<h.length;i++)a=a.replace("{$w"+i+"}",k[i]);for(i=0;i<e.length;i++)a=a.replace("{$h"+i+"}",e[i]);return a},getConfig:function(){return e}},b.exports=h},{"./configuration":21,"./decorators/html":22,"./language_case_rule":26,"./utils":44}],26:[function(a,b,c){var d=a("./utils"),e=a("./rules_engine/parser"),f=a("./rules_engine/evaluator"),g=function(a){d.extend(this,a)};g.prototype={getConditionsExpression:function(){return this.conditions_expression||(this.conditions_expression=new e(this.conditions).parse()),this.conditions_expression},getOperationsExpression:function(){return this.operations_expression||(this.operations_expression=new e(this.operations).parse()),this.operations_expression},getGenderVariables:function(a){if(-1==this.conditions.indexOf("@gender"))return{};if(!a)return{gender:"unknown"};var b=this.language_case.language.getContextByKeyword("gender");return b?b.getVars(a):{gender:"unknown"}},evaluate:function(a,b){if(!this.conditions)return!1;var c=new f;return c.setVars(d.extend({"@value":a},this.getGenderVariables(b))),c.evaluate(this.getConditionsExpression())},apply:function(a){if(!this.operations)return a;var b=new f;return b.setVars({"@value":a}),b.evaluate(this.getOperationsExpression())}},b.exports=g},{"./rules_engine/evaluator":31,"./rules_engine/parser":32,"./utils":44}],27:[function(a,b,c){var d=a("./utils"),e=a("./configuration"),f=a("./language_context_rule"),g=function(a){d.extend(this,a),this.rules={};for(var b=d.keys(a.rules||{}),c=0;c<b.length;c++)this.rules[b[c]]=new f(d.extend(a.rules[b[c]],{language_context:this,keyword:b[c]}))};g.prototype={isAppliedToToken:function(a){var b=new RegExp(this.token_expression.substring(1,this.token_expression.length-2));return null!==a.match(b)},getFallbackRule:function(){if(!this.fallback_rule)for(var a=d.keys(this.rules),b=0;b<a.length;b++){var c=a[b];this.rules[c].isFallback()&&(this.fallback_rule=this.rules[c])}return this.fallback_rule},getConfig:function(){return e.getContextRules(this.keyword)},getVars:function(a){for(var b={},c=this.getConfig(),d=0;d<this.variables.length;d++){var e=this.variables[d];if(c.variables&&c.variables[e]){var f=c.variables[e];"string"==typeof f?(a.object&&(a=a.object),b[e]=a[f]):"function"==typeof f?b[e]=f(a):b[e]=a}else b[e]=a}return b},findMatchingRule:function(a){for(var b=this.getVars(a),c=d.keys(this.rules),e=0;e<c.length;e++){var f=this.rules[c[e]];if(!f.isFallback()&&f.evaluate(b))return f}return this.getFallbackRule()}},b.exports=g},{"./configuration":21,"./language_context_rule":28,"./utils":44}],28:[function(a,b,c){var d=a("./utils"),e=a("./rules_engine/parser"),f=a("./rules_engine/evaluator"),g=function(a){d.extend(this,a)};g.prototype={isFallback:function(){return"other"==this.keyword},getConditionsExpression:function(){return this.conditions_expression||(this.conditions_expression=new e(this.conditions).parse()),this.conditions_expression},evaluate:function(a){if(this.isFallback())return!0;var b=new f;return b.setVars(a||{}),b.evaluate(this.getConditionsExpression())}},b.exports=g},{"./rules_engine/evaluator":31,"./rules_engine/parser":32,"./utils":44}],29:[function(a,b,c){var d=(a("./utils"),{formatDate:function(a){var b=a.getHours(),c=a.getMinutes(),d=a.getSeconds();b%=12,b=b?b:12,c=10>c?"0"+c:c;var e=b+":"+c+":"+d;return a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()+" "+e},log:function(b,c){var d=a("./configuration");if(d.debug){var e="tml: "+b;c&&(e=e+" "+JSON.stringify(c)),console.log(e)}},debug:function(a,b){this.log(a,b)}});b.exports=d},{"./configuration":21,"./utils":44}],30:[function(a,b,c){var d=function(a){function b(a,b){return a<<b|a>>>32-b}function c(a,b){var c,d,e,f,g;return e=2147483648&a,f=2147483648&b,c=1073741824&a,d=1073741824&b,g=(1073741823&a)+(1073741823&b),c&d?2147483648^g^e^f:c|d?1073741824&g?3221225472^g^e^f:1073741824^g^e^f:g^e^f}function d(a,b,c){return a&b|~a&c}function e(a,b,c){return a&c|b&~c}function f(a,b,c){return a^b^c}function g(a,b,c){return b^(a|~c)}function h(a,e,f,g,h,i,j){return a=c(a,c(c(d(e,f,g),h),j)),c(b(a,i),e)}function i(a,d,f,g,h,i,j){return a=c(a,c(c(e(d,f,g),h),j)),c(b(a,i),d)}function j(a,d,e,g,h,i,j){return a=c(a,c(c(f(d,e,g),h),j)),c(b(a,i),d)}function k(a,d,e,f,h,i,j){return a=c(a,c(c(g(d,e,f),h),j)),c(b(a,i),d)}function l(a){for(var b,c=a.length,d=c+8,e=(d-d%64)/64,f=16*(e+1),g=Array(f-1),h=0,i=0;c>i;)b=(i-i%4)/4,h=i%4*8,g[b]=g[b]|a.charCodeAt(i)<<h,i++;return b=(i-i%4)/4,h=i%4*8,g[b]=g[b]|128<<h,g[f-2]=c<<3,g[f-1]=c>>>29,g}function m(a){var b,c,d="",e="";for(c=0;3>=c;c++)b=a>>>8*c&255,e="0"+b.toString(16),d+=e.substr(e.length-2,2);return d}function n(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b}var o,p,q,r,s,t,u,v,w,x=Array(),y=7,z=12,A=17,B=22,C=5,D=9,E=14,F=20,G=4,H=11,I=16,J=23,K=6,L=10,M=15,N=21;for(a=n(a),x=l(a),t=1732584193,u=4023233417,v=2562383102,w=271733878,o=0;o<x.length;o+=16)p=t,q=u,r=v,s=w,t=h(t,u,v,w,x[o+0],y,3614090360),w=h(w,t,u,v,x[o+1],z,3905402710),v=h(v,w,t,u,x[o+2],A,606105819),u=h(u,v,w,t,x[o+3],B,3250441966),t=h(t,u,v,w,x[o+4],y,4118548399),w=h(w,t,u,v,x[o+5],z,1200080426),v=h(v,w,t,u,x[o+6],A,2821735955),u=h(u,v,w,t,x[o+7],B,4249261313),t=h(t,u,v,w,x[o+8],y,1770035416),w=h(w,t,u,v,x[o+9],z,2336552879),v=h(v,w,t,u,x[o+10],A,4294925233),u=h(u,v,w,t,x[o+11],B,2304563134),t=h(t,u,v,w,x[o+12],y,1804603682),w=h(w,t,u,v,x[o+13],z,4254626195),v=h(v,w,t,u,x[o+14],A,2792965006),u=h(u,v,w,t,x[o+15],B,1236535329),t=i(t,u,v,w,x[o+1],C,4129170786),w=i(w,t,u,v,x[o+6],D,3225465664),v=i(v,w,t,u,x[o+11],E,643717713),u=i(u,v,w,t,x[o+0],F,3921069994),t=i(t,u,v,w,x[o+5],C,3593408605),w=i(w,t,u,v,x[o+10],D,38016083),v=i(v,w,t,u,x[o+15],E,3634488961),u=i(u,v,w,t,x[o+4],F,3889429448),t=i(t,u,v,w,x[o+9],C,568446438),w=i(w,t,u,v,x[o+14],D,3275163606),v=i(v,w,t,u,x[o+3],E,4107603335),u=i(u,v,w,t,x[o+8],F,1163531501),t=i(t,u,v,w,x[o+13],C,2850285829),w=i(w,t,u,v,x[o+2],D,4243563512),v=i(v,w,t,u,x[o+7],E,1735328473),u=i(u,v,w,t,x[o+12],F,2368359562),t=j(t,u,v,w,x[o+5],G,4294588738),w=j(w,t,u,v,x[o+8],H,2272392833),v=j(v,w,t,u,x[o+11],I,1839030562),u=j(u,v,w,t,x[o+14],J,4259657740),t=j(t,u,v,w,x[o+1],G,2763975236),w=j(w,t,u,v,x[o+4],H,1272893353),v=j(v,w,t,u,x[o+7],I,4139469664),u=j(u,v,w,t,x[o+10],J,3200236656),t=j(t,u,v,w,x[o+13],G,681279174),w=j(w,t,u,v,x[o+0],H,3936430074),v=j(v,w,t,u,x[o+3],I,3572445317),u=j(u,v,w,t,x[o+6],J,76029189),t=j(t,u,v,w,x[o+9],G,3654602809),w=j(w,t,u,v,x[o+12],H,3873151461),v=j(v,w,t,u,x[o+15],I,530742520),u=j(u,v,w,t,x[o+2],J,3299628645),t=k(t,u,v,w,x[o+0],K,4096336452),w=k(w,t,u,v,x[o+7],L,1126891415),v=k(v,w,t,u,x[o+14],M,2878612391),u=k(u,v,w,t,x[o+5],N,4237533241),t=k(t,u,v,w,x[o+12],K,1700485571),w=k(w,t,u,v,x[o+3],L,2399980690),v=k(v,w,t,u,x[o+10],M,4293915773),u=k(u,v,w,t,x[o+1],N,2240044497),t=k(t,u,v,w,x[o+8],K,1873313359),w=k(w,t,u,v,x[o+15],L,4264355552),v=k(v,w,t,u,x[o+6],M,2734768916),u=k(u,v,w,t,x[o+13],N,1309151649),t=k(t,u,v,w,x[o+4],K,4149444226),w=k(w,t,u,v,x[o+11],L,3174756917),v=k(v,w,t,u,x[o+2],M,718787259),u=k(u,v,w,t,x[o+9],N,3951481745),t=c(t,p),u=c(u,q),v=c(v,r),w=c(w,s);var O=m(t)+m(u)+m(v)+m(w);return O.toLowerCase()};b.exports=d},{}],31:[function(a,b,c){var d=function(a){return this.vars={},this.ctx=a||{label:function(a,b){return this.vars[a]=this.ctx[a]=b,b},quote:function(a){return a},car:function(a){
return a[1]},cdr:function(a){return a.shift(),a},cons:function(a,b){return b.unshift(a),b},eq:function(a,b){return a==b},atom:function(a){return!(typeof a in{object:1,array:1,"function":1})},cond:function(a,b,c){return this.evaluate(a)?this.evaluate(b):this.evaluate(c)},set:function(a,b){return this.vars[a]=this.ctx[a]=b,b},"=":function(a,b){return a==b},"!=":function(a,b){return a!=b},"<":function(a,b){return b>a},">":function(a,b){return a>b},"+":function(a,b){return a+b},"-":function(a,b){return a-b},"*":function(a,b){return a*b},"%":function(a,b){return a%b},mod:function(a,b){return a%b},"/":function(a,b){return 1*a/b},"!":function(a){return!a},not:function(a){return!a},"&&":function(){return Array.prototype.slice.call(arguments).every(this.evaluate.bind(this))},and:function(){return Array.prototype.slice.call(arguments).every(this.evaluate.bind(this))},"||":function(){return!!Array.prototype.slice.call(arguments).filter(this.evaluate.bind(this)).length},or:function(){return!!Array.prototype.slice.call(arguments).filter(this.evaluate.bind(this)).length},"if":function(a,b,c){return this.evaluate(a)?this.evaluate(b):this.evaluate(c)},let:function(a,b){return this.vars[a]=b,b},"true":function(){return!0},"false":function(){return!1},date:function(a){return new Date(a)},today:function(){return new Date},time:function(a){return new Date(a)},now:function(){return Date.now()},append:function(a,b){return String(b)+String(a)},prepend:function(a,b){return String(a)+String(b)},match:function(a,b){return a=this._stringToRegexp(a),!!b.match(a)},"in":function(a,b){var c,d=this._range;return a=a.replace(/\s/g,"").replace(/(\w+)\.\.(\w+)/g,function(a,b,e){return c=d(b,e),c.push(e),c.join()}),-1!=a.split(",").indexOf(String(b))},within:function(a,b){var c=a.split("..").map(function(a){return parseInt(a)});return c[0]<=b&&b<=c[1]},replace:function(a,b,c){return a=this._stringToRegexp(a),c.replace(a,b)},count:function(a){return("string"==typeof a?this.vars[a]:a).length},all:function(a,b){return a="string"==typeof a?this.vars[a]:a,a instanceof Array?a.every(function(a){return a==b}):!1},any:function(a,b){return a="string"==typeof a?this.vars[a]:a,a instanceof Array?!!a.filter(function(a){return a==b}):!1}},this};d.prototype={_range:function(a,b){var c=[],d=!String(a).match(/^\d+$/);for(a=d?a.charCodeAt(0):parseInt(a),b=d?b.charCodeAt(0):parseInt(b);b>=a;)c.push(d?String.fromCharCode(a):String(a)),a+=1;return c},_stringToRegexp:function(a){var b=new RegExp("^/","g");return a.match(b)?(a=a.replace(b,""),a.match(/\/i$/)?(a=a.replace(/\/i$/g,""),new RegExp(a,"ig")):(a=a.replace(/\/$/,""),new RegExp(a,"g"))):new RegExp(a,"g")},setVars:function(a){this.vars=a},getVars:function(){return this.vars},apply:function(a,b){return"function"==typeof this.ctx[a]?this.ctx[a].apply(this,b):this.ctx[a]},evaluate:function(a){if(this.ctx.atom.call(this,a))return"string"==typeof a&&this.vars[a]?this.vars[a]:a in this.ctx?this.ctx[a]:a;var b=a[0],c=a.slice(1);return-1==["quote","car","cdr","cond","if","&&","||","and","or","true","false","let","count","all","any"].indexOf(b)&&(c=c.map(this.evaluate.bind(this))),this.apply(b,c)}},b.exports=d},{}],32:[function(a,b,c){var d=function(a){this.tokenize(a)};d.prototype={tokenize:function(a){this.tokens=a.match(/[()]|\w+|@\w+|[\+\-\!\|\=>&<\*\/%]+|\".*?\"|'.*?'/g)},parse:function(){return token=this.tokens.shift(),token?"("==token?this.parseList():token.match(/^['"].*/)?token.slice(1,-1):token.match(/\d+/)?parseInt(token):String(token):void 0},parseList:function(){for(var a=[];this.tokens.length>0&&")"!=this.tokens[0];)a.push(this.parse());return this.tokens.shift(),a}},b.exports=d},{}],33:[function(a,b,c){var d=a("./utils"),e=(a("./configuration"),a("./translation")),f=function(a){d.extend(this,a),this.key=d.generateSourceKey(a.source),this.translations={},this.ignored_keys=[]};f.prototype={isIgnoredKey:function(a){return-1!=this.ignored_keys.indexOf(a)},getTranslations:function(a,b){return this.translations[a]?this.translations[a][b]:null},updateTranslations:function(a,b){this.ignored_keys=b&&b.ignored_keys?b.ignored_keys:[],b=b&&b.results?b.results:b;var c=d.keys(b);this.translations[a]=this.translations[a]||[];for(var f=0;f<c.length;f++){var g=c[f];this.translations[a][g]=[];var h=b[g];!d.isArray(h)&&h.translations&&(h=h.translations);for(var i=0;i<h.length;i++){var j=h[i];this.translations[a][g].push(new e({locale:j.locale||a,label:j.label,locked:j.locked,context:j.context}))}}}},b.exports=f},{"./configuration":21,"./translation":41,"./utils":44}],34:[function(a,b,c){var d=a("./utils"),e=a("./configuration"),f=a("./logger"),g={version:"0.4.2",Application:a("./application"),Language:a("./language"),LanguageContext:a("./language_context"),LanguageContextRule:a("./language_context_rule"),LanguageCase:a("./language_case"),LanguageCaseRule:a("./language_case_rule"),TranslationKey:a("./translation_key"),Translation:a("./translation"),Translator:a("./translator"),Source:a("./source"),DomTokenizer:a("./tokenizers/dom"),ApiAdapterBase:a("./api_adapters/base"),CacheAdapterBase:a("./cache_adapters/base"),logger:f,utils:d,config:e,scripts:a("./helpers/scripts"),init:function(a){d.merge(e,a),e.initCache()},translate:function(a,b,c,d){var f=this.application.getLanguage(e.current_locale);return f=f||this.application.getLanguage(e.default_locale),f.translate(a,b,c,d)},configure:function(a){a(e)},cache:function(a){var b=e.cache.data||{};b.languages=b.languages||{},b.sources=b.sources||{},e.cache.data=b,a(e.cache.data)}};b.exports=g},{"./api_adapters/base":16,"./application":18,"./cache_adapters/base":20,"./configuration":21,"./helpers/scripts":23,"./language":24,"./language_case":25,"./language_case_rule":26,"./language_context":27,"./language_context_rule":28,"./logger":29,"./source":33,"./tokenizers/dom":37,"./translation":41,"./translation_key":42,"./translator":43,"./utils":44}],35:[function(a,b,c){var d=(a("../configuration"),a("../tokens/data")),e=a("../tokens/method"),f=a("../tokens/piped"),g=function(a){this.label=a,this.tokenize()};g.prototype={tokenize:function(){this.tokens=[];for(var a=this.getSupportedTokens(),b=""+this.label,c=0;c<a.length;c++){for(var d=a[c],e=b.match(d[0])||[],f=0;f<e.length;f++)this.tokens.push(new d[1](e[f],this.label));b=b.replace(a[c][0],"")}},getSupportedTokens:function(){return[[/(%?\{{1,2}\s*\w*\s*(:\s*\w+)*\s*(::\s*\w+)*\s*\}{1,2})/g,d],[/(%?\{{1,2}\s*[\w]*\.\w*\s*(:\s*\w+)*\s*(::\s*\w+)*\s*\}{1,2})/g,e],[/(%?\{{1,2}\s*[\w]*\s*(:\s*\w+)*\s*\|\|?[^\{\}\|]+\}{1,2})/g,f]]},isTokenAllowed:function(a,b){return b.allowed_tokens?-1!=b.allowed_tokens.indexOf(a):!0},substitute:function(a,b,c){c=c||{};for(var d=this.label,e=0;e<this.tokens.length;e++){var f=this.tokens[e];this.isTokenAllowed(f.name,c)&&(d=f.substitute(d,b,a,c))}return d}},b.exports=g},{"../configuration":21,"../tokens/data":38,"../tokens/method":39,"../tokens/piped":40}],36:[function(a,b,c){var d=a("../utils"),e=a("../configuration"),f="tml",g="\\[[\\w]*:",h="\\]",i="\\[[\\w]*\\]",j="\\[\\/[\\w]*\\]",k="<[^\\>]*>",l="<\\/[^\\>]*>",m="[^\\[\\]<>]+",n="short",o="long",p="html",q="{$0}",r=function(a){this.label="["+f+"]"+a+"[/"+f+"]",this.fragments=[],this.tokens=[],this.tokenize()};r.prototype={tokenize:function(){var a=[g,h,i,j,k,l,m].join("|");return a=new RegExp(a,"g"),this.fragments=this.label.match(a),this.fragments},peek:function(){return 0===this.fragments.length?null:this.fragments[0]},getNextFragment:function(){return 0===this.fragments.length?null:this.fragments.shift()},parse:function(){var a=this.getNextFragment();return a.match(new RegExp(g))?this.parseTree(a.replace(/[\[:]/g,""),n):a.match(new RegExp(i))?this.parseTree(a.replace(/[\[\]]/g,""),o):a.match(new RegExp(k))?-1!=a.indexOf("/>")?a:this.parseTree(a.replace(/[<>]/g,"").split(" ")[0],p):a},parseTree:function(a,b){var c=[a];if(-1==this.tokens.indexOf(a)&&a!=f&&this.tokens.push(a),b==n)for(var d=!0;null!==this.peek()&&!this.peek().match(new RegExp(h));){var e=this.parse();d&&"string"==typeof e&&(e=e.replace(/^\s+/,""),d=!1),c.push(e)}else if(b==o)for(;null!==this.peek()&&!this.peek().match(new RegExp(j));)c.push(this.parse());else if(b==p)for(;null!==this.peek()&&!this.peek().match(new RegExp(l));)c.push(this.parse());return this.getNextFragment(),c},isTokenAllowed:function(a){return!this.options.allowed_tokens||-1!=this.options.allowed_tokens.indexOf(a)},getDefaultDecoration:function(a,b){var c=e.getDefaultToken(a,"decoration");if(null===c)return"<"+a+">"+b+"</"+a+">";var f=this.context[a];if(c=c.replace(q,b),d.isObject(f)){for(var g=d.keys(f),h=0;h<g.length;h++)c=c.replace("{$"+g[h]+"}",f[g[h]]);c=c.replace(/[\w]*=['"]\{\$[^\}]*\}['"]/g,"").replace(/\s*>/,">").trim()}return c},apply:function(a,b){if(a==f)return b;if(!this.isTokenAllowed(a))return b;var c=this.context[a];return c?"string"==typeof c?c.replace(q,b):"function"==typeof c?c(b):"object"==typeof c?this.getDefaultDecoration(a,b):b:this.getDefaultDecoration(a,b)},evaluate:function(a){if(!(a instanceof Array))return a;var b=a[0];a.shift();for(var c=this,d=[],e=0;e<a.length;e++)d.push(c.evaluate(a[e]));return this.apply(b,d.join(""))},substitute:function(a,b){this.context=a||{},this.options=b||{};var c=this.evaluate(this.parse());return c=c.replace("[/tml]","")}},b.exports=r},{"../configuration":21,"../utils":44}],37:[function(a,b,c){var d=a("../utils"),e=a("../configuration"),f=function(a,b,c){this.doc=a,this.context=b||{},this.tokens=[],this.options=c||{}};f.prototype={translate:function(){return this.translateTree(this.doc)},translateTree:function(a){if(this.isNonTranslatableNode(a))return a.innerHTML;if(3==a.nodeType)return this.translateTml(a.nodeValue);for(var b="",c="",d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];if(3==e.nodeType)c+=e.nodeValue;else if(this.isInlineNode(e)&&this.hasInlineOrTextSiblings(e)&&!this.isBetweenSeparators(e))c+=this.generateTmlTags(e);else if(this.isSeparatorNode(e))""!==c&&(b+=this.translateTml(c)),b+=this.generateHtmlToken(e),c="";else{""!==c&&(b+=this.translateTml(c));var f=this.translateTree(e);b+=this.isIgnoredNode(e)?f:this.generateHtmlToken(e,f),c=""}}return""!==c&&(b+=this.translateTml(c)),b},isNoTranslate:function(a){if(a.attributes)for(var b=0;b<a.attributes.length;b++){if("notranslate"==a.attributes[b].name)return!0;if("class"==a.attributes[b].name&&-1!=a.attributes[b].value.indexOf("notranslate"))return!0}return!1},isNonTranslatableNode:function(a){if(!a)return!1;if(8==a.nodeType)return!0;if(1==a.nodeType){if(-1!=this.getOption("nodes.scripts").indexOf(a.nodeName.toLowerCase()))return!0;if(0===a.childNodes.length&&""===a.nodeValue)return!0;if(this.isNoTranslate(a))return!0}return!1},translateTml:function(a){if(this.isEmptyString(a))return a;a=this.generateDataTokens(a);var b=this.options.current_language||e.currentLanguage;if(this.getOption("split_sentences")){sentences=d.splitSentences(a),translation=a;var c=this;return sentences.forEach(function(a){var d=c.getOption("debug")?c.debugTranslation(a):b.translate(a,c.tokens,c.options);translation=translation.replace(a,d)}),this.resetContext(),translation}return a=a.replace(/[\n]/g,"").replace(/\s\s+/g," ").trim(),translation=this.getOption("debug")?this.debugTranslation(a):b.translate(a,this.tokens,this.options),this.resetContext(),translation},hasChildNodes:function(a){return a.childNodes?a.childNodes.length>0:!1},isBetweenSeparators:function(a){return this.isSeparatorNode(a.previousSibling)&&!this.isValidTextNode(a.nextSibling)?!0:this.isSeparatorNode(a.nextSibling)&&!this.isValidTextNode(a.previousSibling)?!0:!1},generateTmlTags:function(a){var b="",c=this;if(this.isNoTranslate(a)){var d=this.contextualize(this.adjustName(a),a.innerHTML);return"{"+d+"}"}var e=a.tagName.toLowerCase();if("var"==e)return this.registerDataTokenFromVar(a);for(var f=0;f<a.childNodes.length;f++){var g=a.childNodes[f];b+=3==g.nodeType?g.nodeValue:c.generateTmlTags(g)}var h=c.generateHtmlToken(a),i=this.contextualize(this.adjustName(a),h),j=this.sanitizeValue(b);return this.isSelfClosingNode(a)?"{"+i+"}":this.isShortToken(i,j)?"["+i+": "+j+"]":"["+i+"]"+j+"[/"+i+"]"},registerDataTokenFromVar:function(a){var b={},c="var";if(a.attributes)for(var d=0;d<a.attributes.length;d++){var e=a.attributes[d];""===e.value?c=e.name:b[e.name]=e.value}return b.value=b.value||a.innerHTML,c=this.contextualize(c,a.innerHTML),"{"+c+"}"},getOption:function(a){return"undefined"==typeof this.options[a]||null===this.options[a]?d.hashValue(e.translator_options,a):this.options[a]},debugTranslation:function(a){return this.getOption("debug_format").replace("{$0}",a)},isEmptyString:function(a){return a=a.replace(/[\s\n\r\t\0\x0b\xa0\xc2]/g,""),""===a},resetContext:function(){this.tokens=[].concat(this.context)},isShortToken:function(a,b){return-1!=this.getOption("nodes.short").indexOf(a.toLowerCase())||b.length<20},isOnlyChild:function(a){return a.parentNode?1==a.parentNode.childNodes.length:!1},hasInlineOrTextSiblings:function(a){if(!a.parentNode)return!1;for(var b=0;b<a.parentNode.childNodes.length;b++){var c=a.parentNode.childNodes[b];if(c!=a&&(this.isInlineNode(c)||this.isValidTextNode(c)))return!0}return!1},isInlineNode:function(a){return 1==a.nodeType&&-1!=this.getOption("nodes.inline").indexOf(a.tagName.toLowerCase())&&!this.isOnlyChild(a)},isContainerNode:function(a){return 1==a.nodeType&&!this.isInlineNode(a)},isSelfClosingNode:function(a){return!a.firstChild},isIgnoredNode:function(a){return 1!=a.nodeType?!0:-1!=this.getOption("nodes.ignored").indexOf(a.tagName.toLowerCase())},isValidTextNode:function(a){return a?3==a.nodeType&&!this.isEmptyString(a.nodeValue):!1},isSeparatorNode:function(a){return a?1==a.nodeType&&-1!=this.getOption("nodes.splitters").indexOf(a.tagName.toLowerCase()):!1},sanitizeValue:function(a){return a.replace(/^\s+/,"")},replaceSpecialCharacters:function(a){if(!this.getOption("data_tokens.special.enabled"))return a;var b=a.match(this.getOption("data_tokens.special.regex")),c=this;return b.forEach(function(b){token=b.substring(1,b.length-2),c.context[token]=b,a=a.replace(b,"{"+token+"}")}),a},generateDataTokens:function(a){var b=this;a=this.sanitizeValue(a);var c=null;if(this.getOption("data_tokens.date.enabled")){c=b.getOption("data_tokens.date.name");var d=b.getOption("data_tokens.date.formats");d.forEach(function(d){var e=d[0],f=(d[1],a.match(e));f&&f.forEach(function(d){var e=d,f=b.contextualize(c,e),g="{"+f+"}";a=a.replace(d,g)})})}var e=this.getOption("data_tokens.rules");return e&&e.forEach(function(c){if(c.enabled){var d=a.match(c.regex);d&&d.forEach(function(d){var e=d.trim();if(""!==e){var f=b.contextualize(c.name,e),g=d.replace(e,"{"+f+"}");a=a.replace(d,g)}})}}),a},generateHtmlToken:function(a,b){var c=a.tagName.toLowerCase(),e=a.attributes,f={};if(b=b?b:"{$0}",0===e.length)return this.isSelfClosingNode(a)?"br"==c||"hr"==c?"<"+c+"/>":"<"+c+"></"+c+">":"<"+c+">"+b+"</"+c+">";for(var g=0;g<e.length;g++)f[e[g].name]=e[g].value;var h=d.keys(f);h.sort();var i=[];return h.forEach(function(a){var b=-1!=f[a].indexOf("'")?'"':"'";i.push(a+"="+b+f[a]+b)}),i=i.join(" "),this.isSelfClosingNode(a)?"<"+c+" "+i+"></"+c+">":"<"+c+" "+i+">"+b+"</"+c+">"},adjustName:function(a){var b=a.tagName.toLowerCase(),c=this.getOption("name_mapping");return b=c[b]?c[b]:b},contextualize:function(a,b){if(this.tokens[a]&&this.tokens[a]!=b){var c=0,d=a.match(/\d+$/);return d&&d.length>0&&(c=parseInt(d[d.length-1]),a=a.replace(""+c,"")),a+=c+1,this.contextualize(a,b)}return this.tokens[a]=b,a},debug:function(a){this.doc=a,this.debugTree(a,0)},debugTree:function(a,b){var c=new Array(b+1).join("=");if(console.log(c+"=> "+typeof a+": "+this.nodeInfo(a)),a.childNodes)for(var d=this,e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];d.debugTree(f,b+1)}},nodeInfo:function(a){var b=[];return b.push(a.nodeType),1==a.nodeType&&b.push(a.tagName),this.isInlineNode(a)&&(b.push("inline"),this.hasInlineOrTextSiblings(a)?b.push("sentence"):b.push("only translatable")),this.isSelfClosingNode(a)&&b.push("self closing"),this.isOnlyChild(a)&&b.push("only child"),3==a.nodeType?"["+b.join(", ")+']: "'+a.nodeValue+'"':"["+b.join(", ")+"]"}},b.exports=f},{"../configuration":21,"../utils":44}],38:[function(a,b,c){var d=a("../utils"),e=(a("../logger"),a("../configuration")),f=a("../decorators/html"),g=function(a,b){a&&(this.full_name=a,this.label=b,this.parseElements())};g.prototype={parseElements:function(){var a=this.full_name.replace(/[%\{\}]/g,"").trim(),b=a.split("::")[0].trim();this.short_name=a.split(":")[0].trim(),this.case_keys=[];for(var c=a.match(/(::\s*\w+)/g)||[],d=0;d<c.length;d++)this.case_keys.push(c[d].replace(/[:]/g,"").trim());for(this.context_keys=[],c=b.match(/(:\s*\w+)/g)||[],d=0;d<c.length;d++)this.context_keys.push(c[d].replace(/[:]/g,"").trim())},getContextForLanguage:function(a){return this.context_keys.length>0?a.getContextByKeyword(this.context_keys[0]):a.getContextByTokenName(this.short_name)},getTokenObject:function(a,b){if(!a)return null;b=b||this.short_name;var c=a[b];return d.isArray(c)?c[0]:c&&c.object||c},error:function(a){return this.full_name},getTokenValueFromArrayParam:function(a,b,c){if(c=c||{},0===a.length)return this.error("Invalid number of params of an array");var e=a[0],f=a.length>1?a[1]:null;return d.isArray(e)?this.getTokenValueFromArray(a,b,c):f&&d.isFunction(f)?this.sanitize(f(e),e,b,d.extend(c,{safe:!0})):f?this.sanitize(f.toString(),e,b,d.extend(c,{safe:!0})):this.sanitize(""+e,e,b,d.extend(c,{safe:!1}))},getTokenValueFromHashParam:function(a,b,c){c=c||{};var e=a.value||a.name||a.first_name||a.username,f=a.method,g=a.object;if(f&&d.isFunction(f))return this.sanitize(f(g),g,b,d.extend(c,{safe:!0}));if(e)return this.sanitize(e,g||a,b,d.extend(c,{safe:!0}));if(!g)return this.sanitize(a.toString(),g,b,d.extend(c,{safe:!1}));var h=a.attribute;return h?this.sanitize(g[h],g,b,d.extend(c,{safe:!1})):this.error("Missing value for hash token")},getTokenValueFromArray:function(a,b,c){var e={description:"List joiner",limit:4,separator:", ",joiner:"and",less:"{laquo} less",translate:!1,expandable:!1,collapsable:!0};c=c||{};var g=a[0],h=a.length>1?a[1]:null;a.length>2&&(e=d.extend(e,a[2])),c.skip_decorations&&(e.expandable=!1);for(var i,j=c.target_language||b,k=[],l=0;l<g.length;l++){var m=g[l];if(null===h)i=this.getTokenValueFromHashParam(m,b,c),e.translate&&j&&(i=j.translate(i,"",{},c)),k.push(f.decorateElement(this,i,c));else if(d.isFunction(h))k.push(f.decorateElement(this,this.sanitize(h(m),m,b,d.extend(c,{safe:!0})),c));else if("string"==typeof h)if(h.match(/^@/)){var n=h.replace(/^@/,"");i=m[n]||m[n](),e.translate&&j&&(i=j.translate(i,"",{},c)),k.push(f.decorateElement(this,this.sanitize(i,m,b,d.extend(c,{safe:!1})),c))}else i=""+m,e.translate&&j&&(i=j.translate(i,"",{},c)),k.push(f.decorateElement(this,h.replace("{$0}",this.sanitize(i,m,b,d.extend(c,{safe:!1}))),c));else if(d.isObject(h)){var o=h.attribute||h.property;o&&m[o]?(o=this.sanitize(m[o],m,b,d.extend(c,{safe:!1})),e.translate&&j&&(o=j.translate(o,"",{},c)),h.value?k.push(f.decorateElement(this,h.value.replace("{$0}",o),c)):k.push(f.decorateElement(this,o||""+m,c))):(i=this.getTokenValueFromHashParam(m,b,c),e.translate&&j&&(i=j.translate(i,"",{},c)),k.push(f.decorateElement(this,i,c)))}}if(1==k.length)return k[0];if(!e.joiner||""===e.joiner)return k.join(e.separator);var p=j.translate(e.joiner,e.description,{},c);if(k.length<=e.limit){var q=k.pop();return k.join(e.separator)+" "+p+" "+q}var r=k.slice(0,e.limit),s=k.slice(e.limit),t=r.join(e.separator),u=j.translate("{count || other}",e.description,{count:s.length},c);if(!e.expandable)return t=t+" "+p+" ",d.isFunction(e)?t+e.remainder(s):t+u;var v=e.key?e.key:d.generateKey(this.label,k.join(","));t=t+'<span id="tml_other_link_'+v+'"> '+p+" ",t=t+'<a href="#" class="tml_other_list_link" onClick="document.getElementById(\'tml_other_link_'+v+"').style.display='none'; document.getElementById('tml_other_elements_"+v+"').style.display='inline'; return false;\">",t+=e.remainder&&"function"==typeof e.remainder?e.remainder(s):u,t+="</a></span>",t=t+'<span id="tml_other_elements_'+v+'" style="display:none">'+e.separator;var w=s.pop();return t+=s.join(e.separator),t=t+" "+p+" "+w,e.collapsable&&(t=t+' <a href="#" class="tml_other_less_link" style="font-size:smaller;white-space:nowrap" onClick="document.getElementById(\'tml_other_link_'+v+"').style.display='inline'; document.getElementById('tml_other_elements_"+v+"').style.display='none'; return false;\">",t+=j.translate(e.less,e.description,{},c),t+="</a>"),t+="</span>"},getTokenValue:function(a,b,c){a=a||{},c=c||{};var f=this.short_name in a,g=f?a[this.short_name]:e.getDefaultToken(this.short_name);return"undefined"==typeof g||null===g?this.error("Missing token value"):"string"==typeof g?this.sanitize(g.toString(),g,b,d.extend(c,{safe:!0})):d.isArray(g)?this.getTokenValueFromArrayParam(g,b,c):d.isObject(g)?this.getTokenValueFromHashParam(g,b,c):this.sanitize(g.toString(),g,b,d.extend(c,{safe:!1}))},applyCase:function(a,b,c,d,e){var f=d.getLanguageCaseByKeyword(a);return f?f.apply(b,c,e):b},sanitize:function(a,b,c,e){if(e=e||{},a=""+a,e.safe||(a=d.escapeHTML(a)),this.case_keys.length>0)for(var f=0;f<this.case_keys.length;f++)a=this.applyCase(this.case_keys[f],a,b,c,e);return a},substitute:function(a,b,c,d){return a.replace(this.full_name,f.decorateToken(this,this.getTokenValue(b,c,d),d))},getDecorationName:function(){return"data"}},b.exports=g},{"../configuration":21,"../decorators/html":22,"../logger":29,"../utils":44}],39:[function(a,b,c){var d=a("../utils"),e=a("../decorators/html"),f=a("./data"),g=function(a,b){a&&(this.full_name=a,this.label=b,this.parseElements(),this.initObject())};g.prototype=new f,g.prototype.constructor=g,g.prototype.initObject=function(){var a=this.short_name.split(".");this.short_name=a[0],this.object_method=a[1]},g.prototype.getTokenValue=function(a,b,c){a=a||{};var e=a[this.short_name];if(!e)return this.error("Missing token value");var f;return f=d.isFunction(e[this.object_method])?e[this.object_method]():e[this.object_method]},g.prototype.substitute=function(a,b,c,f){return a.replace(this.full_name,e.decorateToken(this,this.sanitize(this.getTokenValue(b),this.getTokenObject(b),c,d.extend(f,{safe:!1})),f))},g.prototype.getDecorationName=function(){return"method"},b.exports=g},{"../decorators/html":22,"../utils":44,"./data":38}],40:[function(a,b,c){var d=a("../utils"),e=a("../decorators/html"),f=a("./data"),g=function(a,b){a&&(this.full_name=a,this.label=b,this.parseElements())};g.prototype=new f,g.prototype.constructor=g,g.prototype.parseElements=function(){var a=this.full_name.replace(/[%\{\}]/g,"").trim(),b=a.split("|"),c=b[0].trim();this.short_name=c.split(":")[0].trim(),this.case_keys=[];for(var d=c.match(/(::\s*\w+)/g)||[],e=0;e<d.length;e++)this.case_keys.push(d[e].replace(/[:]/g,"").trim());this.context_keys=[];var f=c.split("::")[0].trim();for(d=f.match(/(:\s*\w+)/g)||[],e=0;e<d.length;e++)this.context_keys.push(d[e].replace(/[:]/g,"").trim());if(this.separator=-1!=this.full_name.indexOf("||")?"||":"|",this.parameters=[],b=a.split(this.separator),b.length>1)for(b=b[1].split(","),e=0;e<b.length;e++)this.parameters.push(b[e].trim())},g.prototype.isValueDisplayedInTranslation=function(){return"||"==this.separator},g.prototype.generateValueMapForContext=function(a){var b,c,e={};if(-1!=this.parameters[0].indexOf(":")){for(b=0;b<this.parameters.length;b++){var f=this.parameters[b].split(":");e[f[0].trim()]=f[1].trim()}return e}var g=a.token_mapping;if(!g)return this.error("The token context "+a.keyword+"does not support transformation for unnamed params"),null;if("string"==typeof g)return this.error("The token mapping "+g+" does not support the parameters."),null;if(d.isArray(g)){if(this.parameters.length>g.length)return this.error("The token mapping "+g+" does not support "+this.parameters.length+" parameters"),null;if(g=g[this.parameters.length-1],"string"==typeof g)return this.error("The token mapping "+g+" does not support "+this.parameters.length+" parameters"),null}var h=d.keys(g);for(b=0;b<h.length;b++){var i=h[b],j=g[i];e[i]=j;var k=j.match(/{\$\d(::[\w]+)*\}/g)||[];for(c=0;c<k.length;c++){var l=k[c],m=l.replace(/[\{\}]/g,""),n=m.split("::"),o=parseInt(n[0].replace(/[$]/,""));if(this.parameters.length<o)return this.error("The index inside "+g+" is out of bound: "+this.full_name),null;var p=this.parameters[o];n.shift();for(var q=0;q<n.length;q++){var r=a.language.getLanguageCaseByKeyword(n[q]);r&&(p=r.apply(p))}e[i]=e[i].replace(k[c],p)}}return e},g.prototype.substitute=function(a,b,c,d){if(!(this.short_name in b))return this.error("Missing value"),a;var f=this.getTokenObject(b);if(0===this.parameters.length)return this.error("Piped params may not be empty"),a;var g=this.getContextForLanguage(c),h=this.generateValueMapForContext(g);if(!h)return a;var i=g.findMatchingRule(f);if(null===i)return a;var j=h[i.keyword];if(!j){var k=g.getFallbackRule();if(!k||!h[k.keyword])return this.error("No matching context rule found and no fallback provided"),a;j=h[k.keyword]}var l=[],m=e.decorateToken(this,this.getTokenValue(b,c,d),d);return this.isValueDisplayedInTranslation()?(l.push(m),l.push(" ")):j=j.replace("#"+this.short_name+"#",m),l.push(j),a.replace(this.full_name,l.join(""))},g.prototype.getDecorationName=function(){return"piped"},b.exports=g},{"../decorators/html":22,"../utils":44,"./data":38}],41:[function(a,b,c){var d=a("./utils"),e=a("./tokens/data"),f=function(a){d.extend(this,a),a.language&&(this.locale=a.language.locale)};f.prototype={hasContextRules:function(){return this.context&&d.keys(this.context).length>0},isValidTranslation:function(a){if(!this.hasContextRules())return!0;for(var b=d.keys(this.context),c=0;c<b.length;c++){var f=b[c],g=this.context[f],h=e.prototype.getTokenObject(a,f);if(!h)return!1;for(var i=d.keys(g),j=0;j<i.length;j++){var k=i[j],l=g[i[j]];if("other"!=l){var m=this.language.getContextByKeyword(k);if(!m)return!1;var n=m.findMatchingRule(h);if(!n||n.keyword!=l)return!1}}}return!0}},b.exports=f},{"./tokens/data":38,"./utils":44}],42:[function(a,b,c){var d=a("./utils"),e=a("./configuration"),f=a("./translation"),g=a("./decorators/html"),h=a("./tokenizers/data"),i=a("./tokenizers/decoration"),j=function(a){d.extend(this,a),this.key=this.key||d.generateKey(this.label,this.description),!this.locale&&this.application&&(this.locale=this.application.default_locale),!this.language&&this.application&&(this.language=this.application.getLanguage(this.locale)),this.translations={},this.addTranslations(a.translations||{})};j.prototype={addTranslations:function(a){for(var b=d.keys(a),c=0;c<b.length;c++)for(var e=b[c],g=a[e],h=0;h<g.length;h++){var i=g[h];this.addTranslation(new f(d.extend(i,{language:this.application.getLanguage(i.locale),translation_key:this})))}},addTranslation:function(a){var b=this.translations[a.locale];b||(b=[]),b.push(a),this.translations[a.locale]=b},setTranslations:function(a,b){this.translations[a]=[];for(var c=0;c<b.length;c++){var d=b[c];d.translation_key=this,d.language=this.application.getLanguage(d.locale),this.translations[a].push(d)}},resetTranslations:function(){this.translations={}},getTranslationsForLanguage:function(a){return this.translations?this.translations[a.locale]||[]:[]},findFirstValidTranslation:function(a,b){for(var c=this.getTranslationsForLanguage(a),d=0;d<c.length;d++)if(c[d].isValidTranslation(b))return c[d];return null},translate:function(a,b,c){if(c=c||{},e.isDisabled())return this.substituteTokens(this.label,b,a,c);var d=this.findFirstValidTranslation(a,b),f=g;return d?(c.locked=d.locked,f.decorate(this.substituteTokens(d.label,b,d.language,c),d.language,a,this,c)):(c.target_language=a,f.decorate(this.substituteTokens(this.label,b,this.language||a,c),this.language||a,a,this,c))},getDataTokens:function(){if(!this.data_tokens){var a=new h(this.label);this.data_tokens=a.tokens}return this.data_tokens},getDataTokenNames:function(){if(!this.data_token_names){this.data_token_names=[];for(var a in this.getDataTokens())this.data_token_names.push(a.full_name)}return this.data_token_names},getDecorationTokenNames:function(){if(!this.decoration_tokens){var a=new i(this.label);a.parse(),this.decoration_tokens=a.tokens}return this.decoration_tokens},substituteTokens:function(a,b,c,e){var f;return(-1!=a.indexOf("[")||-1!=a.indexOf("<"))&&(f=new i(a),a=f.substitute(b,d.extend(e,{allowed_tokens:this.getDecorationTokenNames()}))),-1!=a.indexOf("{")&&(f=new h(a),a=f.substitute(c,b,d.extend(e,{allowed_tokens:this.getDataTokenNames()}))),a}},b.exports=j},{"./configuration":21,"./decorators/html":22,"./tokenizers/data":35,"./tokenizers/decoration":36,"./translation":41,"./utils":44}],43:[function(a,b,c){var d=a("./utils"),e=function(a){d.extend(this,a)};e.prototype={isFeatureEnabled:function(a){return this.features&&this.features[a]}},b.exports=e},{"./utils":44}],44:[function(a,b,c){(function(c){var d=a("./md5");b.exports={hashValue:function(a,b,c){c=c||null;for(var d=b.split("."),e=0;e<d.length;e++){var f=d[e];if("undefined"==typeof a[f])return c;a=a[f]}return a},stripTags:function(a,b){b=(((b||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var c=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,d=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return a.replace(d,"").replace(c,function(a,c){return b.indexOf("<"+c.toLowerCase()+">")>-1?a:""})},escapeHtml:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},sanitizeString:function(a){return a?a.replace(/^\s+|\s+$/g,""):""},splitSentences:function(a){var b=/[^.!?\s][^.!?]*(?:[.!?](?![\'"]?\s|$)[^.!?]*)*[.!?]?[\'"]?(?=\s|$)/g;return a.match(b)},unique:function(a){return a.reverse().filter(function(a,b,c){return-1===c.indexOf(a,b+1)}).reverse()},clone:function(a){if(null===a||"undefined"==typeof a||"object"!=typeof a)return a;var b=a.constructor();for(var c in a)b[c]=clone(a[c]);return b},keys:function(a){return Object.keys(a)},generateSourceKey:function(a){return this.isFunction(a)&&(a=a()),d(a)},generateKey:function(a,b){return b=b||"",d(a+";;;"+b)},escapeHTML:function(a){return a.replace(/[&<>]/g,function(a){return{"&":"&amp;","<":"&lt;",">":"&gt;"}[a]||a})},encode:function(a){if(!a)return null;var b=new c(JSON.stringify(a),"utf-8").toString("base64");return encodeURIComponent(b)},decode:function(a){if(!a)return null;try{return JSON.parse(new c(decodeURIComponent(a),"base64").toString("utf-8"))}catch(b){return JSON.parse(new c(decodeURIComponent(decodeURIComponent(a)),"base64").toString("utf-8"))}},normalizeSource:function(a){var b=a.split("?");return b[0]},normalizeParams:function(a,b,c,d){return"object"==typeof a?a:("string"!=typeof b&&(d=c||{},c=b||{},b=""),d=d||{},{label:a,description:b,tokens:c,options:d})},normalizePath:function(a){return("/"==a[0]?"":"/")+a},assign:function(a,b,c){for(var d in b)hasOwnProperty.call(b,d)&&(c&&d in a&&"object"==typeof a[d]&&"object"==typeof b[d]?this.assign(a[d],b[d],c):a[d]=b[d]);return a},extend:function(a){for(var b=1;b<arguments.length;b++)a=this.assign(a,arguments[b]);return a},merge:function(a){for(var b=1;b<arguments.length;b++)a=this.assign(a,arguments[b],!0);return a},addCSS:function(a,b,c){var d=null;return c?(d=a.createElement("style"),d.type="text/css",d.styleSheet?d.styleSheet.cssText=b:d.appendChild(document.createTextNode(b))):(d=a.createElement("link"),d.setAttribute("type","text/css"),d.setAttribute("rel","stylesheet"),d.setAttribute("media","screen"),d.setAttribute("href",b)),a.getElementsByTagName("head")[0].appendChild(d),d},addJS:function(a,b,c,d){var e=a.createElement("script");return e.setAttribute("id",b),e.setAttribute("type","application/javascript"),e.setAttribute("src",c),e.setAttribute("charset","UTF-8"),d&&(e.onload=d),a.getElementsByTagName("head")[0].appendChild(e),e},getCookieName:function(a){return"trex_"+a},getCookie:function(a){for(var b=this.getCookieName(a),c=b+"=",d=document.cookie.split(";"),e=0;e<d.length;e++){for(var f=d[e];" "==f.charAt(0);)f=f.substring(1);if(-1!=f.indexOf(c))return f.substring(c.length,f.length);
}return""},setCookie:function(a,b){var c=this.getCookieName(a);document.cookie=c+"="+b+"; path=/"},templateCache:{},template:function(a,b){var c=this.templateCache,d=/\W/.test(a)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):c[a]=c[a]||this.template(document.getElementById(a).innerHTML);return b?d(b):d},element:function(a){return"string"==typeof a?document.getElementById(a):a},isNumber:function(a){return-1!=a.search(/^\s*\d+\s*$/)},isArray:function(a){return null===a||"undefined"==typeof a?!1:-1!==a.constructor.toString().indexOf("Array")},isObject:function(a){return null===a||"undefined"==typeof a?!1:"object"==typeof a},isFunction:function(a){return"function"==typeof a},isString:function(a){return"string"==typeof a},isURL:function(a){return a=""+a,-1!=a.indexOf("http://")||-1!=a.indexOf("https://")},toQueryParams:function(a){if("undefined"==typeof a||null===a)return"";if("string"==typeof a)return a;var b=[];for(var c in a)b.push(c+"="+encodeURIComponent(a[c]));return b.join("&")},parallel:function(a,b){var c,d=0,e=0,f={},g=function(c){a[c](function(a,g){return a?b(a):(g&&(f[c]=g),e++,void(e==d&&b(null,f)))})};for(c in a)d++;d||b(null,f);for(c in a)g(c)},localizeDate:function(a,b){return a}}}).call(this,a("buffer").Buffer)},{"./md5":30,buffer:8}]},{},[6]);